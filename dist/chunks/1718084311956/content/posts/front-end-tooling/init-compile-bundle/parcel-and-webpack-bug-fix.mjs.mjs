import{createComponent,renderTemplate,maybeRenderHead,unescapeHTML}from"../../../../astro.mjs";import"kleur/colors";import"clsx";import"html-escaper";import"cssesc";const html='<h2 id="issue-1-live-reload">Issue 1: Live Reload<a class="anchor" href="#issue-1-live-reload"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>\n<h3 id="bugs"><strong>🐛</strong>Bugs<a class="anchor" href="#bugs"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p>🐛Parcel dev-server unable to live-load the change made in src/index.js.<br>\n🐛Webpack dev-server unable to live-load the change made in src/index.js.</p>\n<ul>\n<li>”webpack”:“^5.74.0”,</li>\n<li>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>"webpack-cli":"^4.10.0",</span></span>\n<span class="line"><span></span></span></code></pre>\n</li>\n<li>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>"webpack-dev-middleware":"^5.3.3",</span></span>\n<span class="line"><span></span></span></code></pre>\n</li>\n<li>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>"webpack-dev-server":"^4.11.1"</span></span>\n<span class="line"><span></span></span></code></pre>\n</li>\n<li>node: v16.17.1</li>\n<li>ubuntu</li>\n<li>VS Code> wsl</li>\n</ul>\n<h3 id="possible-causes">❓Possible Causes<a class="anchor" href="#possible-causes"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<ul>\n<li>webpack-dev-server 相关配置问题\n<ul>\n<li>比对 <strong>官方文档、指南</strong>，配置 webpack.config.js> dev-server❌</li>\n</ul>\n</li>\n<li>webpack 其他配置影响</li>\n<li>node, sass 等其他 dependencies 影响\n<ul>\n<li>搜索相关问题解决方案：<strong>Stackoverflow, Github, Google</strong>…❌</li>\n<li>终极方案：采取与官方同样的文件架构与代码，一步一步尝试比对 ❌</li>\n</ul>\n</li>\n<li>❓Clue:\n<ul>\n<li>Parcel 与 Webpack 均能成功打包编译文件，服务器首次加载均运行正常</li>\n<li>但 <strong>服务器均无法实时更新本地文件的修改</strong></li>\n</ul>\n</li>\n</ul>\n<h3 id="️log-first-loading-fix-1000-1020-sept-29">🛠️Log: First Loading Fix 10:00-10:20, Sept 29<a class="anchor" href="#️log-first-loading-fix-1000-1020-sept-29"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p>✅Run ‘npm start’, the first load is working fine and update the change made in ‘console.log’!<br>\n❌Unable to live update change in src/index.js<br>\n<img src="https://cdn.nlark.com/yuque/0/2022/png/29677165/1664416973702-68e65c7a-a3cc-4a9c-90bf-508210fb0155.png#clientId=ucbd68a98-1ce1-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=172&#x26;id=UWPpu&#x26;margin=[object-Object]&#x26;name=image.png&#x26;originHeight=343&#x26;originWidth=1833&#x26;originalType=binary&#x26;ratio=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=51378&#x26;status=done&#x26;style=none&#x26;taskId=u92d2cb40-08c8-4134-83c5-c1bb7e82909&#x26;title=&#x26;width=916.5" alt="image.png"></p>\n<h4 id="1-webpackconfigjs">1. webpack.config.js<a class="anchor" href="#1-webpackconfigjs"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#9ECBFF">"use strict"</span><span style="color:#E1E4E8">;</span></span>\n<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> path</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"path"</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#79B8FF">module</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">exports</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#6A737D">\t//   context: __dirname,</span></span>\n<span class="line"><span style="color:#E1E4E8">\tmode: </span><span style="color:#9ECBFF">"development"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\tentry: {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tindex: </span><span style="color:#9ECBFF">"./src/index.js"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\tdevtool: </span><span style="color:#9ECBFF">"source-map"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\toutput: {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tfilename: </span><span style="color:#9ECBFF">"bundle.js"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tpath: path.</span><span style="color:#B392F0">resolve</span><span style="color:#E1E4E8">(__dirname, </span><span style="color:#9ECBFF">"dist"</span><span style="color:#E1E4E8">),</span></span>\n<span class="line"><span style="color:#E1E4E8">\t},</span></span>\n<span class="line"><span style="color:#6A737D">\t//   stats: {</span></span>\n<span class="line"><span style="color:#6A737D">\t//     colors: true,</span></span>\n<span class="line"><span style="color:#6A737D">\t//   },</span></span>\n<span class="line"><span style="color:#E1E4E8">\tdevServer: {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tstatic: </span><span style="color:#9ECBFF">"./dist"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\tmodule: {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\trules: [</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t{</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\ttest:</span><span style="color:#9ECBFF"> /</span><span style="color:#85E89D;font-weight:bold">\\.</span><span style="color:#DBEDFF">s</span><span style="color:#79B8FF">[ac]</span><span style="color:#DBEDFF">ss</span><span style="color:#F97583">$</span><span style="color:#9ECBFF">/</span><span style="color:#F97583">i</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\tuse: [</span></span>\n<span class="line"><span style="color:#9ECBFF">\t\t\t\t\t"style-loader"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#6A737D">\t\t\t\t\t//\'MiniCssExtractPlugin.loader\',</span></span>\n<span class="line"><span style="color:#9ECBFF">\t\t\t\t\t"css-loader"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">\t\t\t\t\t"sass-loader"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t],</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t{</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\ttest:</span><span style="color:#9ECBFF"> /</span><span style="color:#85E89D;font-weight:bold">\\.</span><span style="color:#DBEDFF">(png</span><span style="color:#F97583">|</span><span style="color:#DBEDFF">svg</span><span style="color:#F97583">|</span><span style="color:#DBEDFF">jpg</span><span style="color:#F97583">|</span><span style="color:#DBEDFF">jpeg</span><span style="color:#F97583">|</span><span style="color:#DBEDFF">gif)</span><span style="color:#F97583">$</span><span style="color:#9ECBFF">/</span><span style="color:#F97583">i</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\ttype: </span><span style="color:#9ECBFF">"asset/resource"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t],</span></span>\n<span class="line"><span style="color:#E1E4E8">\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">};</span></span>\n<span class="line"></span></code></pre>\n<h4 id="2-serverjs">2. server.js<a class="anchor" href="#2-serverjs"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#9ECBFF">"use strict"</span><span style="color:#E1E4E8">;</span></span>\n<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> Webpack</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"webpack"</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> WebpackDevServer</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"../lib/Server"</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> webpackConfig</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"./webpack.config"</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> compiler</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> Webpack</span><span style="color:#E1E4E8">(webpackConfig);</span></span>\n<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> devServerOptions</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> { </span><span style="color:#F97583">...</span><span style="color:#E1E4E8">webpackConfig.devServer, open: </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8"> };</span></span>\n<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> server</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> WebpackDevServer</span><span style="color:#E1E4E8">(devServerOptions, compiler);</span></span>\n<span class="line"><span style="color:#E1E4E8">server.</span><span style="color:#B392F0">startCallback</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#E1E4E8">\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Starting server on http://localhost:8080"</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#E1E4E8">});</span></span>\n<span class="line"></span></code></pre>\n<h4 id="3-packagejson">3. package.json<a class="anchor" href="#3-packagejson"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#9ECBFF">"scripts"</span><span style="color:#E1E4E8">: {</span></span>\n<span class="line"><span style="color:#9ECBFF">    "test"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"echo </span><span style="color:#79B8FF">\\"</span><span style="color:#9ECBFF">Error: no test specified</span><span style="color:#79B8FF">\\"</span><span style="color:#9ECBFF"> &#x26;&#x26; exit 1"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">    "start"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"webpack serve --open"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">    "server"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"node server.js"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">    "build"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"webpack"</span></span>\n<span class="line"><span style="color:#E1E4E8">  },</span></span>\n<span class="line"></span></code></pre>\n<h3 id="reference">📑Reference<a class="anchor" href="#reference"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<h3 id="real-cause-and-solution">😊Real Cause and Solution<a class="anchor" href="#real-cause-and-solution"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<ul>\n<li>WSL Ubuntu 实时监测读取本地文件的设置与权限问题\n<ul>\n<li>用 Windows CMD 运行 NPM，以及 webpack-dev-server</li>\n</ul>\n</li>\n<li>最终同样的配置与代码，通过 Windows CMD，webpack-dev-server 成功运行，并能实时加载更新后的本地代码</li>\n</ul>\n<h2 id="issue-2-webpack-compile-and-live-reload-project">Issue 2: Webpack Compile and Live Reload Project<a class="anchor" href="#issue-2-webpack-compile-and-live-reload-project"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>\n<h3 id="webpack-how-to">❓Webpack How-to:<a class="anchor" href="#webpack-how-to"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<ul>\n<li>Use Webpack to build and live-reload page built by the following Tech-stack:\n<ul>\n<li><strong>SASS</strong>, CSS, HTML and JS, with IMG (svg. and png.) files</li>\n</ul>\n</li>\n<li>Pls. Enable Webpack to function as follow:\n<ul>\n<li>Generate an HTML file in ./dist folder based on a template and update changes</li>\n<li>Generate required assets/img folder with required imgs</li>\n<li>Compile all files needed in the project and live-reload changes</li>\n<li>Automatically clean useless files in ./dist</li>\n</ul>\n</li>\n</ul>\n<h3 id="reference-1">📑Reference<a class="anchor" href="#reference-1"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p><a href="https://requestmetrics.com/web-performance/optimizing-static-html-images-webpack">Load HTML and Images with Webpack</a></p>\n<h3 id="solution">😊Solution<a class="anchor" href="#solution"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<h4 id="1-️packagejson">1. 🛠️Package.json<a class="anchor" href="#1-️packagejson"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">{</span></span>\n<span class="line"><span style="color:#9ECBFF">  "name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"forkify-test"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">  "version"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"1.0.0"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">  "private"</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">  "scripts"</span><span style="color:#E1E4E8">: {</span></span>\n<span class="line"><span style="color:#6A737D">    //"test": "echo \\"Error: no test specified\\" &#x26;&#x26; exit 1",</span></span>\n<span class="line"><span style="color:#9ECBFF">    "start"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"webpack-dev-server --mode development"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#6A737D">    //"server": "node server.js",</span></span>\n<span class="line"><span style="color:#9ECBFF">    "build"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"webpack --mode production"</span></span>\n<span class="line"><span style="color:#E1E4E8">  },</span></span>\n<span class="line"><span style="color:#9ECBFF">  "author"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">  "license"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"ISC"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">  "keywords"</span><span style="color:#E1E4E8">: [],</span></span>\n<span class="line"><span style="color:#9ECBFF">  "devDependencies"</span><span style="color:#E1E4E8">: {</span></span>\n<span class="line"><span style="color:#9ECBFF">    "css-loader"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^6.7.1"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#6A737D">    //"express": "^4.18.1",</span></span>\n<span class="line"><span style="color:#9ECBFF">    "html-loader"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^4.2.0"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">    "html-webpack-plugin"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^5.5.0"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">    "image-webpack-loader"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^8.1.0"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#6A737D">    //"mini-css-extract-plugin": "^2.6.1",</span></span>\n<span class="line"><span style="color:#9ECBFF">    "node-sass"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^7.0.3"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">    "sass"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^1.55.0"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">    "sass-loader"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^13.0.2"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">    "style-loader"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^3.3.1"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#6A737D">    //"url-loader": "^4.1.1",</span></span>\n<span class="line"><span style="color:#9ECBFF">    "webpack"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^5.74.0"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">    "webpack-cli"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^4.10.0"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#6A737D">    //"webpack-dev-middleware": "^5.3.3",</span></span>\n<span class="line"><span style="color:#9ECBFF">    "webpack-dev-server"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^4.11.1"</span></span>\n<span class="line"><span style="color:#E1E4E8">  },</span></span>\n<span class="line"><span style="color:#9ECBFF">  "dependencies"</span><span style="color:#E1E4E8">: {</span></span>\n<span class="line"><span style="color:#9ECBFF">    "lodash"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"^4.17.21"</span></span>\n<span class="line"><span style="color:#E1E4E8">  },</span></span>\n<span class="line"><span style="color:#9ECBFF">  "main"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"server.js"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">  "description"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">""</span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"></span></code></pre>\n<h4 id="2-️webpack-configuration">2. 🛠️Webpack Configuration<a class="anchor" href="#2-️webpack-configuration"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> path</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"path"</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> fs</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"fs"</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> HtmlWebpackPlugin</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"html-webpack-plugin"</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#6A737D">// Look for .html files</span></span>\n<span class="line"><span style="color:#F97583">var</span><span style="color:#E1E4E8"> htmlFiles </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [];</span></span>\n<span class="line"><span style="color:#F97583">var</span><span style="color:#E1E4E8"> directories </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"src"</span><span style="color:#E1E4E8">];</span></span>\n<span class="line"><span style="color:#F97583">while</span><span style="color:#E1E4E8"> (directories.</span><span style="color:#79B8FF">length</span><span style="color:#F97583"> ></span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">) {</span></span>\n<span class="line"><span style="color:#F97583">\tvar</span><span style="color:#E1E4E8"> directory </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> directories.</span><span style="color:#B392F0">pop</span><span style="color:#E1E4E8">();</span></span>\n<span class="line"><span style="color:#F97583">\tvar</span><span style="color:#E1E4E8"> dirContents </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> fs</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t.</span><span style="color:#B392F0">readdirSync</span><span style="color:#E1E4E8">(directory)</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t.</span><span style="color:#B392F0">map</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> path.</span><span style="color:#B392F0">join</span><span style="color:#E1E4E8">(directory, file));</span></span>\n<span class="line"><span style="color:#E1E4E8">\thtmlFiles.</span><span style="color:#B392F0">push</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">...</span><span style="color:#E1E4E8">dirContents.</span><span style="color:#B392F0">filter</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> file.</span><span style="color:#B392F0">endsWith</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">".html"</span><span style="color:#E1E4E8">)));</span></span>\n<span class="line"><span style="color:#E1E4E8">\tdirectories.</span><span style="color:#B392F0">push</span><span style="color:#E1E4E8">(</span></span>\n<span class="line"><span style="color:#F97583">\t\t...</span><span style="color:#E1E4E8">dirContents.</span><span style="color:#B392F0">filter</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> fs.</span><span style="color:#B392F0">statSync</span><span style="color:#E1E4E8">(file).</span><span style="color:#B392F0">isDirectory</span><span style="color:#E1E4E8">())</span></span>\n<span class="line"><span style="color:#E1E4E8">\t);</span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"><span style="color:#79B8FF">module</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">exports</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#6A737D">\t//   context: __dirname,</span></span>\n<span class="line"><span style="color:#E1E4E8">\tmode: </span><span style="color:#9ECBFF">"development"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\tentry: </span><span style="color:#9ECBFF">"./src/js/index.js"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\tdevtool: </span><span style="color:#9ECBFF">"source-map"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\toutput: {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tfilename: </span><span style="color:#9ECBFF">"[name].bundle.js"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tpath: path.</span><span style="color:#B392F0">resolve</span><span style="color:#E1E4E8">(__dirname, </span><span style="color:#9ECBFF">"dist"</span><span style="color:#E1E4E8">),</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tclean: </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#6A737D">\t\t// publicPath: \'/img/\',</span></span>\n<span class="line"><span style="color:#E1E4E8">\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\tplugins: [</span></span>\n<span class="line"><span style="color:#6A737D">\t\t// Build a new plugin instance for each .html file found</span></span>\n<span class="line"><span style="color:#F97583">\t\t...</span><span style="color:#E1E4E8">htmlFiles.</span><span style="color:#B392F0">map</span><span style="color:#E1E4E8">(</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t(</span><span style="color:#FFAB70">htmlFile</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span></span>\n<span class="line"><span style="color:#F97583">\t\t\t\tnew</span><span style="color:#B392F0"> HtmlWebpackPlugin</span><span style="color:#E1E4E8">({</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t\ttemplate: htmlFile,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t\tfilename: htmlFile.</span><span style="color:#B392F0">replace</span><span style="color:#E1E4E8">(path.</span><span style="color:#B392F0">normalize</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"src/"</span><span style="color:#E1E4E8">), </span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">),</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t\tinject: </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t})</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t),</span></span>\n<span class="line"><span style="color:#E1E4E8">\t],</span></span>\n<span class="line"><span style="color:#E1E4E8">\tdevServer: {</span></span>\n<span class="line"><span style="color:#6A737D">\t\t// static: { directory: path.join(__dirname, \'dist\') },</span></span>\n<span class="line"><span style="color:#6A737D">\t\t// watchFiles: [\'./src/**/*.*\'],</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tstatic: </span><span style="color:#9ECBFF">"./dist"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\twatchFiles: </span><span style="color:#9ECBFF">"src/**/*.jsx"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\thot: </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tcompress: </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tport: </span><span style="color:#79B8FF">8080</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tclient: {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\tprogress: </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tliveReload: </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\tmodule: {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\trules: [</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t{</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\ttest:</span><span style="color:#9ECBFF"> /</span><span style="color:#85E89D;font-weight:bold">\\.</span><span style="color:#DBEDFF">s</span><span style="color:#79B8FF">[ac]</span><span style="color:#DBEDFF">ss</span><span style="color:#F97583">$</span><span style="color:#9ECBFF">/</span><span style="color:#F97583">i</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\tuse: [</span></span>\n<span class="line"><span style="color:#9ECBFF">\t\t\t\t\t"style-loader"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#6A737D">\t\t\t\t\t//\'MiniCssExtractPlugin.loader\',</span></span>\n<span class="line"><span style="color:#9ECBFF">\t\t\t\t\t"css-loader"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#9ECBFF">\t\t\t\t\t"sass-loader"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t],</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t{</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\ttest:</span><span style="color:#9ECBFF"> /</span><span style="color:#85E89D;font-weight:bold">\\.</span><span style="color:#DBEDFF">html</span><span style="color:#F97583">$</span><span style="color:#9ECBFF">/</span><span style="color:#F97583">i</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\tuse: </span><span style="color:#9ECBFF">"html-loader"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t{</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\ttest:</span><span style="color:#9ECBFF"> /</span><span style="color:#85E89D;font-weight:bold">\\.</span><span style="color:#DBEDFF">(png</span><span style="color:#F97583">|</span><span style="color:#DBEDFF">svg</span><span style="color:#F97583">|</span><span style="color:#DBEDFF">jpg</span><span style="color:#F97583">|</span><span style="color:#DBEDFF">jpeg</span><span style="color:#F97583">|</span><span style="color:#DBEDFF">gif)</span><span style="color:#F97583">$</span><span style="color:#9ECBFF">/</span><span style="color:#F97583">i</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\ttype: </span><span style="color:#9ECBFF">"asset/resource"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\tgenerator: {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t\tfilename: </span><span style="color:#9ECBFF">"img/[name]-[hash][ext]"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t],</span></span>\n<span class="line"><span style="color:#E1E4E8">\t},</span></span>\n<span class="line"><span style="color:#E1E4E8">};</span></span>\n<span class="line"></span></code></pre>\n<h4 id="3-️html-src-template">3. 🛠️HTML Src Template<a class="anchor" href="#3-️html-src-template"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">&#x3C;!--\x3e</span><span style="color:#E1E4E8"> Customized Content </span><span style="color:#F97583">with</span><span style="color:#E1E4E8"> no need to add any script src</span><span style="color:#F97583">&#x3C;--\x3e</span></span>\n<span class="line"></span></code></pre>',frontmatter={topic:null,type:null,category:"Front-End Tooling",Datereviewed:null,reviewed:null,difficulty:null,comment:null,title:"parcel-and-webpack-bug-fix",tags:["Bundler"],status:null,DateStarted:"2022-10-13T00:00:00.000Z",DateModified:"2024-04-19T00:00:00.000Z",draft:!0,minutes:3,words:696},file="E:/SynologyDrive/Codespace/blog-site/mynote/my-fuwari-blog/src/content/posts/front-end-tooling/init-compile-bundle/parcel-and-webpack-bug-fix.md",url=void 0;function rawContent(){return'\n## Issue 1: Live Reload\n\n### **🐛**Bugs\n\n🐛Parcel dev-server unable to live-load the change made in src/index.js.  \n🐛Webpack dev-server unable to live-load the change made in src/index.js.\n\n- "webpack":"^5.74.0",\n-     "webpack-cli":"^4.10.0",\n-     "webpack-dev-middleware":"^5.3.3",\n-     "webpack-dev-server":"^4.11.1"\n- node: v16.17.1\n- ubuntu\n- VS Code> wsl\n\n### ❓Possible Causes\n\n- webpack-dev-server 相关配置问题\n  - 比对 **官方文档、指南**，配置 webpack.config.js> dev-server❌\n- webpack 其他配置影响\n- node, sass 等其他 dependencies 影响\n  - 搜索相关问题解决方案：**Stackoverflow, Github, Google**...❌\n  - 终极方案：采取与官方同样的文件架构与代码，一步一步尝试比对 ❌\n- ❓Clue:\n  - Parcel 与 Webpack 均能成功打包编译文件，服务器首次加载均运行正常\n  - 但 **服务器均无法实时更新本地文件的修改**\n\n### 🛠️Log: First Loading Fix 10:00-10:20, Sept 29\n\n✅Run \'npm start\', the first load is working fine and update the change made in \'console.log\'!  \n❌Unable to live update change in src/index.js  \n![image.png](https://cdn.nlark.com/yuque/0/2022/png/29677165/1664416973702-68e65c7a-a3cc-4a9c-90bf-508210fb0155.png#clientId=ucbd68a98-1ce1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=172&id=UWPpu&margin=%5Bobject-Object%5D&name=image.png&originHeight=343&originWidth=1833&originalType=binary&ratio=1&rotation=0&showTitle=false&size=51378&status=done&style=none&taskId=u92d2cb40-08c8-4134-83c5-c1bb7e82909&title=&width=916.5)\n\n#### 1. webpack.config.js\n\n```jsx\n"use strict";\nconst path = require("path");\nmodule.exports = {\n\t//   context: __dirname,\n\tmode: "development",\n\tentry: {\n\t\tindex: "./src/index.js",\n\t},\n\tdevtool: "source-map",\n\toutput: {\n\t\tfilename: "bundle.js",\n\t\tpath: path.resolve(__dirname, "dist"),\n\t},\n\t//   stats: {\n\t//     colors: true,\n\t//   },\n\tdevServer: {\n\t\tstatic: "./dist",\n\t},\n\tmodule: {\n\t\trules: [\n\t\t\t{\n\t\t\t\ttest: /\\.s[ac]ss$/i,\n\t\t\t\tuse: [\n\t\t\t\t\t"style-loader",\n\t\t\t\t\t//\'MiniCssExtractPlugin.loader\',\n\t\t\t\t\t"css-loader",\n\t\t\t\t\t"sass-loader",\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\ttest: /\\.(png|svg|jpg|jpeg|gif)$/i,\n\t\t\t\ttype: "asset/resource",\n\t\t\t},\n\t\t],\n\t},\n};\n```\n\n#### 2. server.js\n\n```jsx\n"use strict";\nconst Webpack = require("webpack");\nconst WebpackDevServer = require("../lib/Server");\nconst webpackConfig = require("./webpack.config");\nconst compiler = Webpack(webpackConfig);\nconst devServerOptions = { ...webpackConfig.devServer, open: true };\nconst server = new WebpackDevServer(devServerOptions, compiler);\nserver.startCallback(() => {\n\tconsole.log("Starting server on http://localhost:8080");\n});\n```\n\n#### 3. package.json\n\n```jsx\n"scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1",\n    "start": "webpack serve --open",\n    "server": "node server.js",\n    "build": "webpack"\n  },\n```\n\n### 📑Reference\n\n### 😊Real Cause and Solution\n\n- WSL Ubuntu 实时监测读取本地文件的设置与权限问题\n  - 用 Windows CMD 运行 NPM，以及 webpack-dev-server\n- 最终同样的配置与代码，通过 Windows CMD，webpack-dev-server 成功运行，并能实时加载更新后的本地代码\n\n## Issue 2: Webpack Compile and Live Reload Project\n\n### ❓Webpack How-to:\n\n- Use Webpack to build and live-reload page built by the following Tech-stack:\n  - **SASS**, CSS, HTML and JS, with IMG (svg. and png.) files\n- Pls. Enable Webpack to function as follow:\n  - Generate an HTML file in ./dist folder based on a template and update changes\n  - Generate required assets/img folder with required imgs\n  - Compile all files needed in the project and live-reload changes\n  - Automatically clean useless files in ./dist\n\n### 📑Reference\n\n[Load HTML and Images with Webpack](https://requestmetrics.com/web-performance/optimizing-static-html-images-webpack)\n\n### 😊Solution\n\n#### 1. 🛠️Package.json\n\n```jsx\n{\n  "name": "forkify-test",\n  "version": "1.0.0",\n  "private": true,\n  "scripts": {\n    //"test": "echo \\"Error: no test specified\\" && exit 1",\n    "start": "webpack-dev-server --mode development",\n    //"server": "node server.js",\n    "build": "webpack --mode production"\n  },\n  "author": "",\n  "license": "ISC",\n  "keywords": [],\n  "devDependencies": {\n    "css-loader": "^6.7.1",\n    //"express": "^4.18.1",\n    "html-loader": "^4.2.0",\n    "html-webpack-plugin": "^5.5.0",\n    "image-webpack-loader": "^8.1.0",\n    //"mini-css-extract-plugin": "^2.6.1",\n    "node-sass": "^7.0.3",\n    "sass": "^1.55.0",\n    "sass-loader": "^13.0.2",\n    "style-loader": "^3.3.1",\n    //"url-loader": "^4.1.1",\n    "webpack": "^5.74.0",\n    "webpack-cli": "^4.10.0",\n    //"webpack-dev-middleware": "^5.3.3",\n    "webpack-dev-server": "^4.11.1"\n  },\n  "dependencies": {\n    "lodash": "^4.17.21"\n  },\n  "main": "server.js",\n  "description": ""\n}\n```\n\n#### 2. 🛠️Webpack Configuration\n\n```jsx\nconst path = require("path");\nconst fs = require("fs");\nconst HtmlWebpackPlugin = require("html-webpack-plugin");\n// Look for .html files\nvar htmlFiles = [];\nvar directories = ["src"];\nwhile (directories.length > 0) {\n\tvar directory = directories.pop();\n\tvar dirContents = fs\n\t\t.readdirSync(directory)\n\t\t.map((file) => path.join(directory, file));\n\thtmlFiles.push(...dirContents.filter((file) => file.endsWith(".html")));\n\tdirectories.push(\n\t\t...dirContents.filter((file) => fs.statSync(file).isDirectory())\n\t);\n}\nmodule.exports = {\n\t//   context: __dirname,\n\tmode: "development",\n\tentry: "./src/js/index.js",\n\tdevtool: "source-map",\n\toutput: {\n\t\tfilename: "[name].bundle.js",\n\t\tpath: path.resolve(__dirname, "dist"),\n\t\tclean: true,\n\t\t// publicPath: \'/img/\',\n\t},\n\tplugins: [\n\t\t// Build a new plugin instance for each .html file found\n\t\t...htmlFiles.map(\n\t\t\t(htmlFile) =>\n\t\t\t\tnew HtmlWebpackPlugin({\n\t\t\t\t\ttemplate: htmlFile,\n\t\t\t\t\tfilename: htmlFile.replace(path.normalize("src/"), ""),\n\t\t\t\t\tinject: true,\n\t\t\t\t})\n\t\t),\n\t],\n\tdevServer: {\n\t\t// static: { directory: path.join(__dirname, \'dist\') },\n\t\t// watchFiles: [\'./src/**/*.*\'],\n\t\tstatic: "./dist",\n\t\twatchFiles: "src/**/*.jsx",\n\t\thot: true,\n\t\tcompress: true,\n\t\tport: 8080,\n\t\tclient: {\n\t\t\tprogress: true,\n\t\t},\n\t\tliveReload: true,\n\t},\n\tmodule: {\n\t\trules: [\n\t\t\t{\n\t\t\t\ttest: /\\.s[ac]ss$/i,\n\t\t\t\tuse: [\n\t\t\t\t\t"style-loader",\n\t\t\t\t\t//\'MiniCssExtractPlugin.loader\',\n\t\t\t\t\t"css-loader",\n\t\t\t\t\t"sass-loader",\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\ttest: /\\.html$/i,\n\t\t\t\tuse: "html-loader",\n\t\t\t},\n\t\t\t{\n\t\t\t\ttest: /\\.(png|svg|jpg|jpeg|gif)$/i,\n\t\t\t\ttype: "asset/resource",\n\t\t\t\tgenerator: {\n\t\t\t\t\tfilename: "img/[name]-[hash][ext]",\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t},\n};\n```\n\n#### 3. 🛠️HTML Src Template\n\n```jsx\n\x3c!--\x3e Customized Content with no need to add any script src<--\x3e\n```\n'}function compiledContent(){return html}function getHeadings(){return[{depth:2,slug:"issue-1-live-reload",text:"Issue 1: Live Reload#"},{depth:3,slug:"bugs",text:"🐛Bugs#"},{depth:3,slug:"possible-causes",text:"❓Possible Causes#"},{depth:3,slug:"️log-first-loading-fix-1000-1020-sept-29",text:"🛠️Log: First Loading Fix 10:00-10:20, Sept 29#"},{depth:4,slug:"1-webpackconfigjs",text:"1. webpack.config.js#"},{depth:4,slug:"2-serverjs",text:"2. server.js#"},{depth:4,slug:"3-packagejson",text:"3. package.json#"},{depth:3,slug:"reference",text:"📑Reference#"},{depth:3,slug:"real-cause-and-solution",text:"😊Real Cause and Solution#"},{depth:2,slug:"issue-2-webpack-compile-and-live-reload-project",text:"Issue 2: Webpack Compile and Live Reload Project#"},{depth:3,slug:"webpack-how-to",text:"❓Webpack How-to:#"},{depth:3,slug:"reference-1",text:"📑Reference#"},{depth:3,slug:"solution",text:"😊Solution#"},{depth:4,slug:"1-️packagejson",text:"1. 🛠️Package.json#"},{depth:4,slug:"2-️webpack-configuration",text:"2. 🛠️Webpack Configuration#"},{depth:4,slug:"3-️html-src-template",text:"3. 🛠️HTML Src Template#"}]}const Content=createComponent(((s,n,a)=>{const{layout:e,...l}=frontmatter;return l.file=file,l.url=url,renderTemplate`${maybeRenderHead()}${unescapeHTML(html)}`}));export{Content,compiledContent,Content as default,file,frontmatter,getHeadings,rawContent,url};