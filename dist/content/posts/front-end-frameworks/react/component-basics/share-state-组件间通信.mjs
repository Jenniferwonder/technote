import{createComponent,renderTemplate,maybeRenderHead,unescapeHTML}from"../../../../../chunks/1726300354279/astro.mjs";import"kleur/colors";import"clsx";import"html-escaper";import"cssesc";const id="front-end-frameworks/react/component-basics/share-state-组件间通信.md",collection="posts",slug="front-end-frameworks/react/component-basics/share-state-组件间通信",body='# Share State-组件间通信\n>[Sharing State Between Components • React](https://beta.reactjs.org/learn/sharing-state-between-components#recap)\n## 通信方式\nReact 组件之间的通信主要依赖于属性（props）和上下文（context）。以下是 React 组件间通信的几种常见方式：\n### 父组件向子组件传递数据（Props）\n父向子：在子组件函数中传递 `props` 参数，在父组件中使用子组件并向子组件 `props` 通过 `state` 传值\n父组件通过属性（props）将数据传递给子组件。子组件通过 `this.props`（类组件）或函数参数（函数组件）访问传递的数据。这是 React 中最常见的通信方式。\n   ```jsx\n   function ChildComponent(props) {\n   \treturn <div>{props.message}</div>;\n   }\n   class ParentComponent extends React.Component {\n   \trender() {\n   \t\tconst message = "Hello from parent!";\n   \t\treturn <ChildComponent message={message} />;\n   \t}\n   }\n   ```\n### 子组件向父组件传递数据（回调函数）\n子向父：通过传入事件处理函数，改变父组件 `state`  \n子组件不能直接修改父组件的状态。为了让子组件向父组件传递数据，父组件可以将一个回调函数作为属性传递给子组件。子组件调用该回调函数时，可以将数据作为参数传递，从而实现向父组件传递数据。\n   ```jsx\n   function ChildComponent(props) {\n   \treturn (\n   \t\t<button onClick={() => props.handleMessage("Hello from child!")}>\n   \t\t\tSend Message\n   \t\t</button>\n   \t);\n   }\n   class ParentComponent extends React.Component {\n   \thandleMessage(message) {\n   \t\tconsole.log(message);\n   \t}\n   \trender() {\n   \t\treturn <ChildComponent handleMessage={this.handleMessage.bind(this)} />;\n   \t}\n   }\n   ```\n### 兄弟组件间通信\n兄弟组件间的通信需要依赖于它们共同的父组件。父组件可以通过状态（state）和回调函数将兄弟组件间的数据传递。\n   ```jsx\n   class ParentComponent extends React.Component {\n   \tstate = {\n   \t\tmessage: "",\n   \t};\n   \thandleMessage(message) {\n   \t\tthis.setState({ message });\n   \t}\n   \trender() {\n   \t\treturn (\n   \t\t\t<div>\n   \t\t\t\t<ChildComponent1 handleMessage={this.handleMessage.bind(this)} />\n   \t\t\t\t<ChildComponent2 message={this.state.message} />\n   \t\t\t</div>\n   \t\t);\n   \t}\n   }\n   ```\n### 多层嵌套组件间通信 \n使用上下文（Context）\n当多层嵌套的组件需要通信时，逐层传递属性可能变得繁琐。这时可以使用 React 的上下文（Context）API。Context 提供了一种在组件树中共享数据的方式，而无需显式地传递属性。\n   ```jsx\n   const MessageContext = React.createContext();\n   class ParentComponent extends React.Component {\n   \tstate = {\n   \t\tmessage: "Hello from context!",\n   \t};\n   \trender() {\n   \t\treturn (\n   \t\t\t<MessageContext.Provider value={this.state.message}>\n   \t\t\t\t<ChildComponent />\n   \t\t\t</MessageContext.Provider>\n   \t\t);\n   \t}\n   }\n   function ChildComponent() {\n   \treturn (\n   \t\t<MessageContext.Consumer>\n   \t\t\t{(message) => <div>{message}</div>}\n   \t\t</MessageContext.Consumer>\n   \t);\n   }\n   ```\n5. 使用状态管理库（如 Redux）： 在大型应用程序中，组件之间的通信可能变得复杂。使用状态管理库（如 Redux）可以集中管理应用程序的状态，简化组件间的通信。组件可以通过连接到状态管理库（如 Redux）来访问和更新全局状态。  \n   使用 Redux 管理状态可以让你更好地处理大型应用程序中的组件间通信和共享状态。在实际项目中，你可能还需要使用一些额外的工具和技术，例如 Redux Toolkit、Redux Thunk 或 Redux Saga。\n\n## Reference\n- When you want to coordinate two components, move their state to their common parent.\n- Then pass the information down through props from their common parent.\n- Finally, pass the event handlers down so that the children can change the parent\'s state.\n- It\'s useful to consider components as **“controlled” (driven by props)** or **“uncontrolled” (driven by state)**.\n### React Key\n#### [需要把 keys 设置为全局唯一吗？](https://github.com/haizlin/fe-interview/issues/884)\n#### [React 中遍历时为什么不用索引作为唯一的 key 值？](https://github.com/haizlin/fe-interview/issues/643)\n#### [React 中的 key 有什么作用？](https://github.com/haizlin/fe-interview/issues/642)\n#### React key 是干嘛用的 为什么要加？key 主要是解决哪一类问题的\n### Props\n#### [React 组件的 state 和 props 两者有什么区别？](https://github.com/haizlin/fe-interview/issues/645)\n#### [怎么在 JSX 里使用自定义属性？](https://github.com/haizlin/fe-interview/issues/813)\n#### [怎么在 JSX 里属性可以被覆盖吗？覆盖的原则是什么？](https://github.com/haizlin/fe-interview/issues/814)\n#### [如何给非控组件设置默认的值？](https://github.com/haizlin/fe-interview/issues/894)\n#### [为什么说 React 中的 props 是只读的？](https://github.com/haizlin/fe-interview/issues/924)\n#### [如果组件的属性没有传值，那么它的默认值是什么？](https://github.com/haizlin/fe-interview/issues/900)\n#### [在 React 中组件的 props 改变时更新组件的有哪些方法？](https://github.com/haizlin/fe-interview/issues/824)\n#### [React 中验证 props 的目的是什么？](https://github.com/haizlin/fe-interview/issues/790)\n#### [React 中怎么检验 props？](https://github.com/haizlin/fe-interview/issues/787)\n#### [React 中你有使用过 getDefaultProps 吗？它有什么作用？](https://github.com/haizlin/fe-interview/issues/789)\n#### [给组件设置很多属性时不想一个个去设置有什么办法可以解决这问题呢？](https://github.com/haizlin/fe-interview/issues/784)\n#### [immutable 的原理是什么？](https://github.com/haizlin/fe-interview/issues/823)\n#### [你对 immutable 有了解吗？它有什么作用？](https://github.com/haizlin/fe-interview/issues/822)\n#### [React 中你有使用过 propType 吗？它有什么作用？](https://github.com/haizlin/fe-interview/issues/788)\n#### [使用 PropTypes 和 Flow 有什么区别？](https://github.com/haizlin/fe-interview/issues/869)\n### Portal & Slot\n#### [举例说明 React 的插槽有哪些运用场景？](https://github.com/haizlin/fe-interview/issues/934)\n#### [你有用过 React 的插槽(Portals)吗？怎么用？](https://github.com/haizlin/fe-interview/issues/933)\n#### [请说说 React 中 Portal 是什么？](https://github.com/haizlin/fe-interview/issues/687)\n## React 组件间通信 (props, children)\n- 概念\n- ![z-React-CDD-组件插槽用法.png|400](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/z-React-CDD-%E7%BB%84%E4%BB%B6%E6%8F%92%E6%A7%BD%E7%94%A8%E6%B3%95.png)\n- 组件的 `children` 子元素\n- ![React-CDD-插槽-children.png|350](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-%E6%8F%92%E6%A7%BD-children.png)\n  - ![React-CDD-children.png|425](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-children.png)\n  - 弊端\n    - children 数量被限制\n      - 1 个 (值为对象)\n        - `children: button`\n      - 多个 (值为对象数组)\n        - `children: [button, ...]`\n  - 限制只能传一个元素\n  - ![React-CDD-children-1.png](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-children-1.png)\n- `props` 属性传递 React 元素\n  - ![React-CDD-props.png|325](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-props.png)\n![1701567850607.png|500](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/1701567850607.png)\n',data={title:"Share State-组件间通信",DateStarted:new Date(171288e7),tags:["React"],category:"Front-End Frameworks"},_internal={type:"content",filePath:"E:/SynologyDrive/Codespace/blog-site/mynote/my-fuwari-blog/src/content/posts/front-end-frameworks/react/component-basics/share-state-组件间通信.md",rawData:void 0},html='<h1 id="share-state-组件间通信">Share State-组件间通信<a class="anchor" href="#share-state-组件间通信"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h1>\n<blockquote>\n<p><a href="https://beta.reactjs.org/learn/sharing-state-between-components#recap">Sharing State Between Components • React</a></p>\n</blockquote>\n<h2 id="通信方式">通信方式<a class="anchor" href="#通信方式"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>\n<p>React 组件之间的通信主要依赖于属性（props）和上下文（context）。以下是 React 组件间通信的几种常见方式：</p>\n<h3 id="父组件向子组件传递数据props">父组件向子组件传递数据（Props）<a class="anchor" href="#父组件向子组件传递数据props"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p>父向子：在子组件函数中传递 <code>props</code> 参数，在父组件中使用子组件并向子组件 <code>props</code> 通过 <code>state</code> 传值\n父组件通过属性（props）将数据传递给子组件。子组件通过 <code>this.props</code>（类组件）或函数参数（函数组件）访问传递的数据。这是 React 中最常见的通信方式。</p>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> ChildComponent</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">props</span><span style="color:#E1E4E8">) {</span></span>\n<span class="line"><span style="color:#F97583">\treturn</span><span style="color:#E1E4E8"> &#x3C;</span><span style="color:#85E89D">div</span><span style="color:#E1E4E8">>{props.message}&#x3C;/</span><span style="color:#85E89D">div</span><span style="color:#E1E4E8">>;</span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> ParentComponent</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> React</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">Component</span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#B392F0">\trender</span><span style="color:#E1E4E8">() {</span></span>\n<span class="line"><span style="color:#F97583">\t\tconst</span><span style="color:#79B8FF"> message</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> "Hello from parent!"</span><span style="color:#E1E4E8">;</span></span>\n<span class="line"><span style="color:#F97583">\t\treturn</span><span style="color:#E1E4E8"> &#x3C;</span><span style="color:#79B8FF">ChildComponent</span><span style="color:#B392F0"> message</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{message} />;</span></span>\n<span class="line"><span style="color:#E1E4E8">\t}</span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"></span></code></pre>\n<h3 id="子组件向父组件传递数据回调函数">子组件向父组件传递数据（回调函数）<a class="anchor" href="#子组件向父组件传递数据回调函数"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p>子向父：通过传入事件处理函数，改变父组件 <code>state</code><br>\n子组件不能直接修改父组件的状态。为了让子组件向父组件传递数据，父组件可以将一个回调函数作为属性传递给子组件。子组件调用该回调函数时，可以将数据作为参数传递，从而实现向父组件传递数据。</p>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> ChildComponent</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">props</span><span style="color:#E1E4E8">) {</span></span>\n<span class="line"><span style="color:#F97583">\treturn</span><span style="color:#E1E4E8"> (</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t&#x3C;</span><span style="color:#85E89D">button</span><span style="color:#B392F0"> onClick</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{() </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> props.</span><span style="color:#B392F0">handleMessage</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Hello from child!"</span><span style="color:#E1E4E8">)}></span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\tSend Message</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t&#x3C;/</span><span style="color:#85E89D">button</span><span style="color:#E1E4E8">></span></span>\n<span class="line"><span style="color:#E1E4E8">\t);</span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> ParentComponent</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> React</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">Component</span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#B392F0">\thandleMessage</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">message</span><span style="color:#E1E4E8">) {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(message);</span></span>\n<span class="line"><span style="color:#E1E4E8">\t}</span></span>\n<span class="line"><span style="color:#B392F0">\trender</span><span style="color:#E1E4E8">() {</span></span>\n<span class="line"><span style="color:#F97583">\t\treturn</span><span style="color:#E1E4E8"> &#x3C;</span><span style="color:#79B8FF">ChildComponent</span><span style="color:#B392F0"> handleMessage</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.handleMessage.</span><span style="color:#B392F0">bind</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">)} />;</span></span>\n<span class="line"><span style="color:#E1E4E8">\t}</span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"></span></code></pre>\n<h3 id="兄弟组件间通信">兄弟组件间通信<a class="anchor" href="#兄弟组件间通信"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p>兄弟组件间的通信需要依赖于它们共同的父组件。父组件可以通过状态（state）和回调函数将兄弟组件间的数据传递。</p>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> ParentComponent</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> React</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">Component</span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#FFAB70">\tstate</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tmessage: </span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t};</span></span>\n<span class="line"><span style="color:#B392F0">\thandleMessage</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">message</span><span style="color:#E1E4E8">) {</span></span>\n<span class="line"><span style="color:#79B8FF">\t\tthis</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">setState</span><span style="color:#E1E4E8">({ message });</span></span>\n<span class="line"><span style="color:#E1E4E8">\t}</span></span>\n<span class="line"><span style="color:#B392F0">\trender</span><span style="color:#E1E4E8">() {</span></span>\n<span class="line"><span style="color:#F97583">\t\treturn</span><span style="color:#E1E4E8"> (</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t&#x3C;</span><span style="color:#85E89D">div</span><span style="color:#E1E4E8">></span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t&#x3C;</span><span style="color:#79B8FF">ChildComponent1</span><span style="color:#B392F0"> handleMessage</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.handleMessage.</span><span style="color:#B392F0">bind</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">)} /></span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t&#x3C;</span><span style="color:#79B8FF">ChildComponent2</span><span style="color:#B392F0"> message</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.state.message} /></span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t&#x3C;/</span><span style="color:#85E89D">div</span><span style="color:#E1E4E8">></span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t);</span></span>\n<span class="line"><span style="color:#E1E4E8">\t}</span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"></span></code></pre>\n<h3 id="多层嵌套组件间通信">多层嵌套组件间通信<a class="anchor" href="#多层嵌套组件间通信"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p>使用上下文（Context）\n当多层嵌套的组件需要通信时，逐层传递属性可能变得繁琐。这时可以使用 React 的上下文（Context）API。Context 提供了一种在组件树中共享数据的方式，而无需显式地传递属性。</p>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> MessageContext</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> React.</span><span style="color:#B392F0">createContext</span><span style="color:#E1E4E8">();</span></span>\n<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> ParentComponent</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> React</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">Component</span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#FFAB70">\tstate</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tmessage: </span><span style="color:#9ECBFF">"Hello from context!"</span><span style="color:#E1E4E8">,</span></span>\n<span class="line"><span style="color:#E1E4E8">\t};</span></span>\n<span class="line"><span style="color:#B392F0">\trender</span><span style="color:#E1E4E8">() {</span></span>\n<span class="line"><span style="color:#F97583">\t\treturn</span><span style="color:#E1E4E8"> (</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t&#x3C;</span><span style="color:#79B8FF">MessageContext.Provider</span><span style="color:#B392F0"> value</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.state.message}></span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t\t&#x3C;</span><span style="color:#79B8FF">ChildComponent</span><span style="color:#E1E4E8"> /></span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t&#x3C;/</span><span style="color:#79B8FF">MessageContext.Provider</span><span style="color:#E1E4E8">></span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t);</span></span>\n<span class="line"><span style="color:#E1E4E8">\t}</span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> ChildComponent</span><span style="color:#E1E4E8">() {</span></span>\n<span class="line"><span style="color:#F97583">\treturn</span><span style="color:#E1E4E8"> (</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t&#x3C;</span><span style="color:#79B8FF">MessageContext.Consumer</span><span style="color:#E1E4E8">></span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t\t{(</span><span style="color:#FFAB70">message</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> &#x3C;</span><span style="color:#85E89D">div</span><span style="color:#E1E4E8">>{message}&#x3C;/</span><span style="color:#85E89D">div</span><span style="color:#E1E4E8">>}</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\t&#x3C;/</span><span style="color:#79B8FF">MessageContext.Consumer</span><span style="color:#E1E4E8">></span></span>\n<span class="line"><span style="color:#E1E4E8">\t);</span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"></span></code></pre>\n<ol start="5">\n<li>使用状态管理库（如 Redux）： 在大型应用程序中，组件之间的通信可能变得复杂。使用状态管理库（如 Redux）可以集中管理应用程序的状态，简化组件间的通信。组件可以通过连接到状态管理库（如 Redux）来访问和更新全局状态。<br>\n使用 Redux 管理状态可以让你更好地处理大型应用程序中的组件间通信和共享状态。在实际项目中，你可能还需要使用一些额外的工具和技术，例如 Redux Toolkit、Redux Thunk 或 Redux Saga。</li>\n</ol>\n<h2 id="reference">Reference<a class="anchor" href="#reference"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>\n<ul>\n<li>When you want to coordinate two components, move their state to their common parent.</li>\n<li>Then pass the information down through props from their common parent.</li>\n<li>Finally, pass the event handlers down so that the children can change the parent’s state.</li>\n<li>It’s useful to consider components as <strong>“controlled” (driven by props)</strong> or <strong>“uncontrolled” (driven by state)</strong>.</li>\n</ul>\n<h3 id="react-key">React Key<a class="anchor" href="#react-key"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<h4 id="需要把-keys-设置为全局唯一吗"><a href="https://github.com/haizlin/fe-interview/issues/884">需要把 keys 设置为全局唯一吗？</a><a class="anchor" href="#需要把-keys-设置为全局唯一吗"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="react-中遍历时为什么不用索引作为唯一的-key-值"><a href="https://github.com/haizlin/fe-interview/issues/643">React 中遍历时为什么不用索引作为唯一的 key 值？</a><a class="anchor" href="#react-中遍历时为什么不用索引作为唯一的-key-值"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="react-中的-key-有什么作用"><a href="https://github.com/haizlin/fe-interview/issues/642">React 中的 key 有什么作用？</a><a class="anchor" href="#react-中的-key-有什么作用"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="react-key-是干嘛用的-为什么要加key-主要是解决哪一类问题的">React key 是干嘛用的 为什么要加？key 主要是解决哪一类问题的<a class="anchor" href="#react-key-是干嘛用的-为什么要加key-主要是解决哪一类问题的"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h3 id="props">Props<a class="anchor" href="#props"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<h4 id="react-组件的-state-和-props-两者有什么区别"><a href="https://github.com/haizlin/fe-interview/issues/645">React 组件的 state 和 props 两者有什么区别？</a><a class="anchor" href="#react-组件的-state-和-props-两者有什么区别"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="怎么在-jsx-里使用自定义属性"><a href="https://github.com/haizlin/fe-interview/issues/813">怎么在 JSX 里使用自定义属性？</a><a class="anchor" href="#怎么在-jsx-里使用自定义属性"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="怎么在-jsx-里属性可以被覆盖吗覆盖的原则是什么"><a href="https://github.com/haizlin/fe-interview/issues/814">怎么在 JSX 里属性可以被覆盖吗？覆盖的原则是什么？</a><a class="anchor" href="#怎么在-jsx-里属性可以被覆盖吗覆盖的原则是什么"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="如何给非控组件设置默认的值"><a href="https://github.com/haizlin/fe-interview/issues/894">如何给非控组件设置默认的值？</a><a class="anchor" href="#如何给非控组件设置默认的值"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="为什么说-react-中的-props-是只读的"><a href="https://github.com/haizlin/fe-interview/issues/924">为什么说 React 中的 props 是只读的？</a><a class="anchor" href="#为什么说-react-中的-props-是只读的"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="如果组件的属性没有传值那么它的默认值是什么"><a href="https://github.com/haizlin/fe-interview/issues/900">如果组件的属性没有传值，那么它的默认值是什么？</a><a class="anchor" href="#如果组件的属性没有传值那么它的默认值是什么"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="在-react-中组件的-props-改变时更新组件的有哪些方法"><a href="https://github.com/haizlin/fe-interview/issues/824">在 React 中组件的 props 改变时更新组件的有哪些方法？</a><a class="anchor" href="#在-react-中组件的-props-改变时更新组件的有哪些方法"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="react-中验证-props-的目的是什么"><a href="https://github.com/haizlin/fe-interview/issues/790">React 中验证 props 的目的是什么？</a><a class="anchor" href="#react-中验证-props-的目的是什么"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="react-中怎么检验-props"><a href="https://github.com/haizlin/fe-interview/issues/787">React 中怎么检验 props？</a><a class="anchor" href="#react-中怎么检验-props"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="react-中你有使用过-getdefaultprops-吗它有什么作用"><a href="https://github.com/haizlin/fe-interview/issues/789">React 中你有使用过 getDefaultProps 吗？它有什么作用？</a><a class="anchor" href="#react-中你有使用过-getdefaultprops-吗它有什么作用"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="给组件设置很多属性时不想一个个去设置有什么办法可以解决这问题呢"><a href="https://github.com/haizlin/fe-interview/issues/784">给组件设置很多属性时不想一个个去设置有什么办法可以解决这问题呢？</a><a class="anchor" href="#给组件设置很多属性时不想一个个去设置有什么办法可以解决这问题呢"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="immutable-的原理是什么"><a href="https://github.com/haizlin/fe-interview/issues/823">immutable 的原理是什么？</a><a class="anchor" href="#immutable-的原理是什么"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="你对-immutable-有了解吗它有什么作用"><a href="https://github.com/haizlin/fe-interview/issues/822">你对 immutable 有了解吗？它有什么作用？</a><a class="anchor" href="#你对-immutable-有了解吗它有什么作用"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="react-中你有使用过-proptype-吗它有什么作用"><a href="https://github.com/haizlin/fe-interview/issues/788">React 中你有使用过 propType 吗？它有什么作用？</a><a class="anchor" href="#react-中你有使用过-proptype-吗它有什么作用"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="使用-proptypes-和-flow-有什么区别"><a href="https://github.com/haizlin/fe-interview/issues/869">使用 PropTypes 和 Flow 有什么区别？</a><a class="anchor" href="#使用-proptypes-和-flow-有什么区别"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h3 id="portal--slot">Portal &#x26; Slot<a class="anchor" href="#portal--slot"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<h4 id="举例说明-react-的插槽有哪些运用场景"><a href="https://github.com/haizlin/fe-interview/issues/934">举例说明 React 的插槽有哪些运用场景？</a><a class="anchor" href="#举例说明-react-的插槽有哪些运用场景"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="你有用过-react-的插槽portals吗怎么用"><a href="https://github.com/haizlin/fe-interview/issues/933">你有用过 React 的插槽(Portals)吗？怎么用？</a><a class="anchor" href="#你有用过-react-的插槽portals吗怎么用"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h4 id="请说说-react-中-portal-是什么"><a href="https://github.com/haizlin/fe-interview/issues/687">请说说 React 中 Portal 是什么？</a><a class="anchor" href="#请说说-react-中-portal-是什么"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<h2 id="react-组件间通信-props-children">React 组件间通信 (props, children)<a class="anchor" href="#react-组件间通信-props-children"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>\n<ul>\n<li>概念</li>\n<li><img src="https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/z-React-CDD-组件插槽用法.png" alt="z-React-CDD-组件插槽用法.png|400"></li>\n<li>组件的 <code>children</code> 子元素</li>\n<li><img src="https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-插槽-children.png" alt="React-CDD-插槽-children.png|350">\n<ul>\n<li><img src="https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-children.png" alt="React-CDD-children.png|425"></li>\n<li>弊端\n<ul>\n<li>children 数量被限制\n<ul>\n<li>1 个 (值为对象)\n<ul>\n<li><code>children: button</code></li>\n</ul>\n</li>\n<li>多个 (值为对象数组)\n<ul>\n<li><code>children: [button, ...]</code></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>限制只能传一个元素</li>\n<li><img src="https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-children-1.png" alt="React-CDD-children-1.png"></li>\n</ul>\n</li>\n<li><code>props</code> 属性传递 React 元素\n<ul>\n<li><img src="https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-props.png" alt="React-CDD-props.png|325">\n<img src="https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/1701567850607.png" alt="1701567850607.png|500"></li>\n</ul>\n</li>\n</ul>',frontmatter={aliases:["Share State-组件间通信"],title:"Share State-组件间通信",topic:["Component-Basics"],type:"D",tags:["React"],DateStarted:"2024-04-12T00:00:00.000Z",DateModified:"2024-06-16T00:00:00.000Z",Datereviewed:"2024-04-12T00:00:00.000Z",reviewed:1,difficulty:null,status:null,comment:null,"linter-yaml-title-alias":"Share State-组件间通信",category:"Front-End Frameworks",minutes:6,words:1143},file="E:/SynologyDrive/Codespace/blog-site/mynote/my-fuwari-blog/src/content/posts/front-end-frameworks/react/component-basics/share-state-组件间通信.md",url=void 0;function rawContent(){return'# Share State-组件间通信\n>[Sharing State Between Components • React](https://beta.reactjs.org/learn/sharing-state-between-components#recap)\n## 通信方式\nReact 组件之间的通信主要依赖于属性（props）和上下文（context）。以下是 React 组件间通信的几种常见方式：\n### 父组件向子组件传递数据（Props）\n父向子：在子组件函数中传递 `props` 参数，在父组件中使用子组件并向子组件 `props` 通过 `state` 传值\n父组件通过属性（props）将数据传递给子组件。子组件通过 `this.props`（类组件）或函数参数（函数组件）访问传递的数据。这是 React 中最常见的通信方式。\n   ```jsx\n   function ChildComponent(props) {\n   \treturn <div>{props.message}</div>;\n   }\n   class ParentComponent extends React.Component {\n   \trender() {\n   \t\tconst message = "Hello from parent!";\n   \t\treturn <ChildComponent message={message} />;\n   \t}\n   }\n   ```\n### 子组件向父组件传递数据（回调函数）\n子向父：通过传入事件处理函数，改变父组件 `state`  \n子组件不能直接修改父组件的状态。为了让子组件向父组件传递数据，父组件可以将一个回调函数作为属性传递给子组件。子组件调用该回调函数时，可以将数据作为参数传递，从而实现向父组件传递数据。\n   ```jsx\n   function ChildComponent(props) {\n   \treturn (\n   \t\t<button onClick={() => props.handleMessage("Hello from child!")}>\n   \t\t\tSend Message\n   \t\t</button>\n   \t);\n   }\n   class ParentComponent extends React.Component {\n   \thandleMessage(message) {\n   \t\tconsole.log(message);\n   \t}\n   \trender() {\n   \t\treturn <ChildComponent handleMessage={this.handleMessage.bind(this)} />;\n   \t}\n   }\n   ```\n### 兄弟组件间通信\n兄弟组件间的通信需要依赖于它们共同的父组件。父组件可以通过状态（state）和回调函数将兄弟组件间的数据传递。\n   ```jsx\n   class ParentComponent extends React.Component {\n   \tstate = {\n   \t\tmessage: "",\n   \t};\n   \thandleMessage(message) {\n   \t\tthis.setState({ message });\n   \t}\n   \trender() {\n   \t\treturn (\n   \t\t\t<div>\n   \t\t\t\t<ChildComponent1 handleMessage={this.handleMessage.bind(this)} />\n   \t\t\t\t<ChildComponent2 message={this.state.message} />\n   \t\t\t</div>\n   \t\t);\n   \t}\n   }\n   ```\n### 多层嵌套组件间通信 \n使用上下文（Context）\n当多层嵌套的组件需要通信时，逐层传递属性可能变得繁琐。这时可以使用 React 的上下文（Context）API。Context 提供了一种在组件树中共享数据的方式，而无需显式地传递属性。\n   ```jsx\n   const MessageContext = React.createContext();\n   class ParentComponent extends React.Component {\n   \tstate = {\n   \t\tmessage: "Hello from context!",\n   \t};\n   \trender() {\n   \t\treturn (\n   \t\t\t<MessageContext.Provider value={this.state.message}>\n   \t\t\t\t<ChildComponent />\n   \t\t\t</MessageContext.Provider>\n   \t\t);\n   \t}\n   }\n   function ChildComponent() {\n   \treturn (\n   \t\t<MessageContext.Consumer>\n   \t\t\t{(message) => <div>{message}</div>}\n   \t\t</MessageContext.Consumer>\n   \t);\n   }\n   ```\n5. 使用状态管理库（如 Redux）： 在大型应用程序中，组件之间的通信可能变得复杂。使用状态管理库（如 Redux）可以集中管理应用程序的状态，简化组件间的通信。组件可以通过连接到状态管理库（如 Redux）来访问和更新全局状态。  \n   使用 Redux 管理状态可以让你更好地处理大型应用程序中的组件间通信和共享状态。在实际项目中，你可能还需要使用一些额外的工具和技术，例如 Redux Toolkit、Redux Thunk 或 Redux Saga。\n\n## Reference\n- When you want to coordinate two components, move their state to their common parent.\n- Then pass the information down through props from their common parent.\n- Finally, pass the event handlers down so that the children can change the parent\'s state.\n- It\'s useful to consider components as **“controlled” (driven by props)** or **“uncontrolled” (driven by state)**.\n### React Key\n#### [需要把 keys 设置为全局唯一吗？](https://github.com/haizlin/fe-interview/issues/884)\n#### [React 中遍历时为什么不用索引作为唯一的 key 值？](https://github.com/haizlin/fe-interview/issues/643)\n#### [React 中的 key 有什么作用？](https://github.com/haizlin/fe-interview/issues/642)\n#### React key 是干嘛用的 为什么要加？key 主要是解决哪一类问题的\n### Props\n#### [React 组件的 state 和 props 两者有什么区别？](https://github.com/haizlin/fe-interview/issues/645)\n#### [怎么在 JSX 里使用自定义属性？](https://github.com/haizlin/fe-interview/issues/813)\n#### [怎么在 JSX 里属性可以被覆盖吗？覆盖的原则是什么？](https://github.com/haizlin/fe-interview/issues/814)\n#### [如何给非控组件设置默认的值？](https://github.com/haizlin/fe-interview/issues/894)\n#### [为什么说 React 中的 props 是只读的？](https://github.com/haizlin/fe-interview/issues/924)\n#### [如果组件的属性没有传值，那么它的默认值是什么？](https://github.com/haizlin/fe-interview/issues/900)\n#### [在 React 中组件的 props 改变时更新组件的有哪些方法？](https://github.com/haizlin/fe-interview/issues/824)\n#### [React 中验证 props 的目的是什么？](https://github.com/haizlin/fe-interview/issues/790)\n#### [React 中怎么检验 props？](https://github.com/haizlin/fe-interview/issues/787)\n#### [React 中你有使用过 getDefaultProps 吗？它有什么作用？](https://github.com/haizlin/fe-interview/issues/789)\n#### [给组件设置很多属性时不想一个个去设置有什么办法可以解决这问题呢？](https://github.com/haizlin/fe-interview/issues/784)\n#### [immutable 的原理是什么？](https://github.com/haizlin/fe-interview/issues/823)\n#### [你对 immutable 有了解吗？它有什么作用？](https://github.com/haizlin/fe-interview/issues/822)\n#### [React 中你有使用过 propType 吗？它有什么作用？](https://github.com/haizlin/fe-interview/issues/788)\n#### [使用 PropTypes 和 Flow 有什么区别？](https://github.com/haizlin/fe-interview/issues/869)\n### Portal & Slot\n#### [举例说明 React 的插槽有哪些运用场景？](https://github.com/haizlin/fe-interview/issues/934)\n#### [你有用过 React 的插槽(Portals)吗？怎么用？](https://github.com/haizlin/fe-interview/issues/933)\n#### [请说说 React 中 Portal 是什么？](https://github.com/haizlin/fe-interview/issues/687)\n## React 组件间通信 (props, children)\n- 概念\n- ![z-React-CDD-组件插槽用法.png|400](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/z-React-CDD-%E7%BB%84%E4%BB%B6%E6%8F%92%E6%A7%BD%E7%94%A8%E6%B3%95.png)\n- 组件的 `children` 子元素\n- ![React-CDD-插槽-children.png|350](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-%E6%8F%92%E6%A7%BD-children.png)\n  - ![React-CDD-children.png|425](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-children.png)\n  - 弊端\n    - children 数量被限制\n      - 1 个 (值为对象)\n        - `children: button`\n      - 多个 (值为对象数组)\n        - `children: [button, ...]`\n  - 限制只能传一个元素\n  - ![React-CDD-children-1.png](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-children-1.png)\n- `props` 属性传递 React 元素\n  - ![React-CDD-props.png|325](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/React-CDD-props.png)\n![1701567850607.png|500](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/full-stack/1701567850607.png)\n'}function compiledContent(){return html}function getHeadings(){return[{depth:1,slug:"share-state-组件间通信",text:"Share State-组件间通信#"},{depth:2,slug:"通信方式",text:"通信方式#"},{depth:3,slug:"父组件向子组件传递数据props",text:"父组件向子组件传递数据（Props）#"},{depth:3,slug:"子组件向父组件传递数据回调函数",text:"子组件向父组件传递数据（回调函数）#"},{depth:3,slug:"兄弟组件间通信",text:"兄弟组件间通信#"},{depth:3,slug:"多层嵌套组件间通信",text:"多层嵌套组件间通信#"},{depth:2,slug:"reference",text:"Reference#"},{depth:3,slug:"react-key",text:"React Key#"},{depth:4,slug:"需要把-keys-设置为全局唯一吗",text:"需要把 keys 设置为全局唯一吗？#"},{depth:4,slug:"react-中遍历时为什么不用索引作为唯一的-key-值",text:"React 中遍历时为什么不用索引作为唯一的 key 值？#"},{depth:4,slug:"react-中的-key-有什么作用",text:"React 中的 key 有什么作用？#"},{depth:4,slug:"react-key-是干嘛用的-为什么要加key-主要是解决哪一类问题的",text:"React key 是干嘛用的 为什么要加？key 主要是解决哪一类问题的#"},{depth:3,slug:"props",text:"Props#"},{depth:4,slug:"react-组件的-state-和-props-两者有什么区别",text:"React 组件的 state 和 props 两者有什么区别？#"},{depth:4,slug:"怎么在-jsx-里使用自定义属性",text:"怎么在 JSX 里使用自定义属性？#"},{depth:4,slug:"怎么在-jsx-里属性可以被覆盖吗覆盖的原则是什么",text:"怎么在 JSX 里属性可以被覆盖吗？覆盖的原则是什么？#"},{depth:4,slug:"如何给非控组件设置默认的值",text:"如何给非控组件设置默认的值？#"},{depth:4,slug:"为什么说-react-中的-props-是只读的",text:"为什么说 React 中的 props 是只读的？#"},{depth:4,slug:"如果组件的属性没有传值那么它的默认值是什么",text:"如果组件的属性没有传值，那么它的默认值是什么？#"},{depth:4,slug:"在-react-中组件的-props-改变时更新组件的有哪些方法",text:"在 React 中组件的 props 改变时更新组件的有哪些方法？#"},{depth:4,slug:"react-中验证-props-的目的是什么",text:"React 中验证 props 的目的是什么？#"},{depth:4,slug:"react-中怎么检验-props",text:"React 中怎么检验 props？#"},{depth:4,slug:"react-中你有使用过-getdefaultprops-吗它有什么作用",text:"React 中你有使用过 getDefaultProps 吗？它有什么作用？#"},{depth:4,slug:"给组件设置很多属性时不想一个个去设置有什么办法可以解决这问题呢",text:"给组件设置很多属性时不想一个个去设置有什么办法可以解决这问题呢？#"},{depth:4,slug:"immutable-的原理是什么",text:"immutable 的原理是什么？#"},{depth:4,slug:"你对-immutable-有了解吗它有什么作用",text:"你对 immutable 有了解吗？它有什么作用？#"},{depth:4,slug:"react-中你有使用过-proptype-吗它有什么作用",text:"React 中你有使用过 propType 吗？它有什么作用？#"},{depth:4,slug:"使用-proptypes-和-flow-有什么区别",text:"使用 PropTypes 和 Flow 有什么区别？#"},{depth:3,slug:"portal--slot",text:"Portal & Slot#"},{depth:4,slug:"举例说明-react-的插槽有哪些运用场景",text:"举例说明 React 的插槽有哪些运用场景？#"},{depth:4,slug:"你有用过-react-的插槽portals吗怎么用",text:"你有用过 React 的插槽(Portals)吗？怎么用？#"},{depth:4,slug:"请说说-react-中-portal-是什么",text:"请说说 React 中 Portal 是什么？#"},{depth:2,slug:"react-组件间通信-props-children",text:"React 组件间通信 (props, children)#"}]}const Content=createComponent(((n,s,e)=>{const{layout:t,...a}=frontmatter;return a.file=file,a.url=url,renderTemplate`${maybeRenderHead()}${unescapeHTML(html)}`})),shareState______=Object.freeze(Object.defineProperty({__proto__:null,Content:Content,compiledContent:compiledContent,default:Content,file:file,frontmatter:frontmatter,getHeadings:getHeadings,rawContent:rawContent,url:url},Symbol.toStringTag,{value:"Module"}));export{_internal,body,collection,data,id,shareState______,slug};