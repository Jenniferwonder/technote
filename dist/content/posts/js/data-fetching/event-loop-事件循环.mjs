import{createComponent,renderTemplate,maybeRenderHead,unescapeHTML}from"../../../../chunks/1713773016041/astro.mjs";import"kleur/colors";import"clsx";import"html-escaper";import"cssesc";const id="js/data-fetching/event-loop-äº‹ä»¶å¾ªç¯.md",collection="posts",slug="js/data-fetching/event-loop-äº‹ä»¶å¾ªç¯",body="\n# Event Loop-äº‹ä»¶å¾ªç¯\n\n## What is JavaScript?\n\n- [How JavaScript works](https://link.juejin.cn/?target=https%3A%2F%2Fblog.sessionstack.com%2Fhow-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5 https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5)\n- A **single-threaded** non-blocking asynchronous concurrent language.\n- å•çº¿ç¨‹ã€æ— é˜»å¡ã€å¼‚æ­¥ã€å¹¶å‘\n- Have **a call stack**, an event loop, a callback queue and other APIs...\n\n### V8\n\n- A JS runtime\n- Have a callstack and a heap\n- The V8 can do one thing at a time, but not the browser which can access other APIs.\n\n## Event Loop (äº‹ä»¶è½®è¯¢æœºåˆ¶)\n\n### macrotask çš„æœ¬è´¨\n\n[æ·±å…¥æµè§ˆå™¨äº‹ä»¶å¾ªç¯çš„æœ¬è´¨ Â· Issue #160 Â· frontend9/fe9-library Â· GitHub](https://github.com/frontend9/fe9-library/issues/160)\n\n> macrotask æœ¬è´¨ä¸Šæ˜¯æµè§ˆå™¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´é€šä¿¡çš„ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—  \n> åœ¨ chrome é‡Œï¼Œæ¯ä¸ªé¡µé¢éƒ½å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹åˆæœ‰å¤šä¸ªçº¿ç¨‹ï¼Œæ¯”å¦‚ js çº¿ç¨‹ã€æ¸²æŸ“çº¿ç¨‹ã€io çº¿ç¨‹ã€ç½‘ç»œçº¿ç¨‹ã€å®šæ—¶å™¨çº¿ç¨‹ç­‰ï¼Œè¿™äº›çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œæ˜¯é€šè¿‡å‘å¯¹æ–¹çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªä»»åŠ¡ï¼ˆPostTaskï¼‰æ¥å®ç°çš„ã€‚\n\n### Reference\n\n- â­[What the heck is the event loop anyway? | Philip Roberts | JSConf EU - YouTube](https://www.youtube.com/watch?v=8aGhZQkoFbQ)\n- â­[Jake Archibald on the web browser event loop, setTimeout, micro tasks, requestAnimationFrame, ... - YouTube](https://www.youtube.com/watch?v=cCOL7MC4Pl0)\n- [è¿™ä¸€æ¬¡ï¼Œå½»åº•å¼„æ‡‚ JavaScript æ‰§è¡Œæœºåˆ¶](https://juejin.cn/post/6844903512845860872 https://juejin.cn/post/6844903512845860872)\n- [ä» event loop è§„èŒƒæ¢ç©¶ javaScript å¼‚æ­¥åŠæµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faooy%2Fblog%2Fissues%2F5 https://github.com/aooy/blog/issues/5)\n- [ã€THE LAST TIMEã€‘å½»åº•åƒé€ JavaScript æ‰§è¡Œæœºåˆ¶](https://juejin.cn/post/6844903955286196237 https://juejin.cn/post/6844903955286196237)\n- [ä¸€æ¬¡å¼„æ‡‚ Event Loopï¼ˆå½»åº•è§£å†³æ­¤ç±»é¢è¯•é—®é¢˜ï¼‰](https://juejin.cn/post/6844903764202094606 https://juejin.cn/post/6844903764202094606)\n- [æ·±å…¥ç†è§£ JavaScript Event Loop](https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F34229323 https://zhuanlan.zhihu.com/p/34229323)\n\n### Event Loop Execution Process\n\n- call stack > Web APIs > callback queue > ğŸ”event loop > task in callback queue? push task to the end of stack\n- è°ƒç”¨æ ˆã€å †æ ˆæº¢å‡ºï¼ˆstack overflowï¼‰ã€å›è°ƒé˜Ÿåˆ—/ä»»åŠ¡é˜Ÿåˆ—ï¼ˆå›è°ƒå‡½æ•°ï¼‰ã€äº‹ä»¶å¾ªç¯ã€\n- render queueï¼šé‡ç»˜\n\n  ![](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/programming/Pasted-image-20221208182251.png)\n\n#### äº‹ä»¶è½®è¯¢æœºåˆ¶æ‰§è¡Œè¿‡ç¨‹\n\n1ï¼‰ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡æ”¾åœ¨ä¸åŒçš„ä»»åŠ¡é˜Ÿåˆ—ä¸­  \n2ï¼‰å½“æŸä¸ªå®ä»»åŠ¡æ‰§è¡Œå®Œå,ä¼šæŸ¥çœ‹å¾®ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æœ‰ä»»åŠ¡ã€‚å¦‚æœæœ‰ï¼Œæ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å¾®ä»»åŠ¡ (æ³¨æ„è¿™é‡Œæ˜¯æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡)  \n3ï¼‰å¾®ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œä¼šè¯»å–å®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ’åœ¨æœ€å‰çš„ç¬¬ä¸€ä¸ªå®ä»»åŠ¡ï¼ˆæ³¨æ„å®ä»»åŠ¡æ˜¯ä¸€ä¸ªä¸ªå–ï¼‰ï¼Œæ‰§è¡Œè¯¥å®ä»»åŠ¡ï¼Œå¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å¾®ä»»åŠ¡ï¼Œä¾æ¬¡åŠ å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—  \n4ï¼‰å®ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œå†æ¬¡è¯»å–å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ï¼Œä¾æ¬¡ç±»æ¨ã€‚\n\n### å®ä»»åŠ¡ å¾®ä»»åŠ¡\n\nå®ä»»åŠ¡æ˜¯ä¸€ä¸ªä¸ªæ‰§è¡Œï¼Œæ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼Œç„¶åå°±æŠŠåœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å¾®ä»»åŠ¡éƒ½æ‰§è¡Œå®Œï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ï¼Œå†æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ï¼Œä¾æ¬¡ç±»æ¨\n\n### Reference\n\n- [Tasks, microtasks, queues and schedules](https://link.juejin.cn/?target=https%3A%2F%2Fjakearchibald.com%2F2015%2Ftasks-microtasks-queues-and-schedules%2F https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/)\n- [è¯¦è§£å®ä»»åŠ¡ã€å¾®ä»»åŠ¡ä¸äº‹ä»¶å¾ªç¯ Event Loop - æ˜é‡‘](https://juejin.cn/post/7020710294083092493)\n\n### å®ä»»åŠ¡ï¼ˆMacrotasksï¼‰\n\nä¸»çº¿ç¨‹ä¸Šæ’é˜Ÿæ‰§è¡Œçš„ä»»åŠ¡ï¼Œåªæœ‰å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡\n\n- script å…¨éƒ¨ä»£ç ï¼ˆæ³¨æ„åŒæ­¥ä»£ç ä¹Ÿå±äºå®ä»»åŠ¡ï¼‰\n- setTimeoutã€setIntervalã€setImmediate ç­‰\n\n### å¾®ä»»åŠ¡ï¼ˆMicrotasksï¼‰\n\nä¸è¿›å…¥ä¸»çº¿ç¨‹ã€è€Œè¿›å…¥ å¾®ä»»åŠ¡åˆ—è¡¨ çš„ä»»åŠ¡\n\n- Promiseã€MutationObserver\n\n### Event loop ä¸ æµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº\n\n1ï¼‰ æµè§ˆå™¨æ›´æ–°æ¸²æŸ“ä¼šåœ¨ event loop ä¸­çš„ å®ä»»åŠ¡ å’Œ å¾®ä»»åŠ¡ å®Œæˆåè¿›è¡Œï¼Œå³ `å®ä»»åŠ¡ â†’ å¾®ä»»åŠ¡ â†’ æ¸²æŸ“æ›´æ–°`ï¼ˆå…ˆå®ä»»åŠ¡ å†å¾®ä»»åŠ¡ï¼Œç„¶åå†æ¸²æŸ“æ›´æ–°ï¼‰  \n2ï¼‰å®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœæœ‰å¤§é‡ä»»åŠ¡ç­‰å¾…æ‰§è¡Œæ—¶ï¼Œå°† `domçš„å˜åŠ¨ä½œä¸ºå¾®ä»»åŠ¡ï¼Œèƒ½æ›´å¿«çš„å°†å˜åŒ–å‘ˆç°ç»™ç”¨æˆ·`ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™ä¸€æ¬¡çš„äº‹ä»¶è½®è¯¢ä¸­æ›´æ–° dom\n\n## `requestAnimationFrame`\n\n- [ã€ä»Šå¤©ä½ æ›´åšå­¦äº†ä¹ˆã€‘ä¸€ä¸ªç¥å¥‡çš„å‰ç«¯åŠ¨ç”» API requestAnimationFrame - æ˜é‡‘](https://juejin.cn/post/6991297852462858277?searchId=202402181438115229F57507550A5779CE)\n- [æ€§èƒ½ä¼˜åŒ–ä¹‹é€šä¿—æ˜“æ‡‚å­¦ä¹  requestAnimationFrame å’Œä½¿ç”¨åœºæ™¯ä¸¾ä¾‹ - æ˜é‡‘](https://juejin.cn/post/7190728064458817591?searchId=202402181438115229F57507550A5779CE)\n- [å¦ä¸€ç§æ¸²æŸ“å¤§é‡æ•°æ®çš„é«˜æ•ˆæ–¹æ³•ï¼šrequestAnimationFrame - æ˜é‡‘](https://juejin.cn/post/7274346507037016104?searchId=202402181438115229F57507550A5779CE)\n- [åˆ©ç”¨ requestAnimationFrame ä¼˜åŒ–å¤§æ•°æ®åˆ—è¡¨æ¸²æŸ“ - æ˜é‡‘](https://juejin.cn/post/7262900590937063482?searchId=202402181438115229F57507550A5779CE)\n\n## ğŸ› ï¸ Interview Exercise\n\n#### Event Loop ç»å…¸é¢˜ç›®ï¼šåˆ¤æ–­æ‰“å°ç»“æœ\n\n```javascript\nPromise.resolve()\n\t.then(function () {\n\t\tconsole.log(promise0);\n\t})\n\t.then(function () {\n\t\tconsole.log(promise5);\n\t});\nsetTimeout(() => {\n\tconsole.log(timer1);\n\tPromise.resolve().then(function () {\n\t\tconsole.log(promise2);\n\t});\n\tPromise.resolve().then(function () {\n\t\tconsole.log(promise4);\n\t});\n}, 0);\nsetTimeout(() => {\n\tconsole.log(timer2);\n\tPromise.resolve().then(function () {\n\t\tconsole.log(promise3);\n\t});\n}, 0);\nPromise.resolve().then(function () {\n\tconsole.log(promise1);\n});\nconsole.log(start);\n\n// æ‰“å°ç»“æœï¼š start promise0 promise1 promise5 timer1 promise2 promise4 timer2 promise3\n```\n\n#### äº‹ä»¶è½®è¯¢æ‰§è¡Œæ—¶æœº\n\nasync éšå¼è¿”å› Promiseï¼Œä¼šäº§ç”Ÿä¸€ä¸ªå¾®ä»»åŠ¡ï¼Œawait åé¢çš„ä»£ç æ˜¯åœ¨å¾®ä»»åŠ¡æ—¶æ‰§è¡Œ\n\n```javascript\nconsole.log(script start);\nasync function async1() {\n\tawait async2(); // await éšå¼è¿”å›promise\n\tconsole.log(async1 end); // è¿™é‡Œçš„æ‰§è¡Œæ—¶æœºï¼šåœ¨æ‰§è¡Œå¾®ä»»åŠ¡æ—¶æ‰§è¡Œ\n}\nasync function async2() {\n\tconsole.log(async2 end); // è¿™é‡Œæ˜¯åŒæ­¥ä»£ç \n}\nasync1();\nsetTimeout(function () {\n\tconsole.log(setTimeout);\n}, 0);\nnew Promise((resolve) => {\n\tconsole.log(Promise); // è¿™é‡Œæ˜¯åŒæ­¥ä»£ç \n\tresolve();\n})\n\t.then(function () {\n\t\tconsole.log(promise1);\n\t})\n\t.then(function () {\n\t\tconsole.log(promise2);\n\t});\nconsole.log(script end);\n\n// æ‰“å°ç»“æœ:  script start => async2 end => Promise => script end => async1 end => promise1 => promise2 => setTimeout\n```\n\n## â“[Node.js Event Loop](Node.js-Event-Loop)\n\n## â“[Vue å¼‚æ­¥æ›´æ–° (Event loop ä¸ Vue nextTick)](<../Vue-å¼‚æ­¥æ›´æ–°-(Event-loop-ä¸-Vue-nextTick)>>)\n",data={title:"Event Loop-äº‹ä»¶å¾ªç¯",DateStarted:new Date(16704576e5),tags:["JavaScript"],category:"Programming"},_internal={type:"content",filePath:"E:/SynologyDrive/Codespace/blog-site/mynote/my-fuwari-blog/src/content/posts/js/data-fetching/event-loop-äº‹ä»¶å¾ªç¯.md",rawData:void 0},html='<h1 id="event-loop-äº‹ä»¶å¾ªç¯">Event Loop-äº‹ä»¶å¾ªç¯<a class="anchor" href="#event-loop-äº‹ä»¶å¾ªç¯"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h1>\n<h2 id="what-is-javascript">What is JavaScript?<a class="anchor" href="#what-is-javascript"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>\n<ul>\n<li>[How JavaScript works](<a href="https://link.juejin.cn/?target=https%3A%2F%2Fblog.sessionstack.com%2Fhow-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5">https://link.juejin.cn/?target=https%3A%2F%2Fblog.sessionstack.com%2Fhow-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5</a> <a href="https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5">https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5</a>)</li>\n<li>A <strong>single-threaded</strong> non-blocking asynchronous concurrent language.</li>\n<li>å•çº¿ç¨‹ã€æ— é˜»å¡ã€å¼‚æ­¥ã€å¹¶å‘</li>\n<li>Have <strong>a call stack</strong>, an event loop, a callback queue and other APIsâ€¦</li>\n</ul>\n<h3 id="v8">V8<a class="anchor" href="#v8"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<ul>\n<li>A JS runtime</li>\n<li>Have a callstack and a heap</li>\n<li>The V8 can do one thing at a time, but not the browser which can access other APIs.</li>\n</ul>\n<h2 id="event-loop-äº‹ä»¶è½®è¯¢æœºåˆ¶">Event Loop (äº‹ä»¶è½®è¯¢æœºåˆ¶)<a class="anchor" href="#event-loop-äº‹ä»¶è½®è¯¢æœºåˆ¶"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>\n<h3 id="macrotask-çš„æœ¬è´¨">macrotask çš„æœ¬è´¨<a class="anchor" href="#macrotask-çš„æœ¬è´¨"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p><a href="https://github.com/frontend9/fe9-library/issues/160">æ·±å…¥æµè§ˆå™¨äº‹ä»¶å¾ªç¯çš„æœ¬è´¨ Â· Issue #160 Â· frontend9/fe9-library Â· GitHub</a></p>\n<blockquote>\n<p>macrotask æœ¬è´¨ä¸Šæ˜¯æµè§ˆå™¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´é€šä¿¡çš„ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—<br>\nåœ¨ chrome é‡Œï¼Œæ¯ä¸ªé¡µé¢éƒ½å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹åˆæœ‰å¤šä¸ªçº¿ç¨‹ï¼Œæ¯”å¦‚ js çº¿ç¨‹ã€æ¸²æŸ“çº¿ç¨‹ã€io çº¿ç¨‹ã€ç½‘ç»œçº¿ç¨‹ã€å®šæ—¶å™¨çº¿ç¨‹ç­‰ï¼Œè¿™äº›çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œæ˜¯é€šè¿‡å‘å¯¹æ–¹çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªä»»åŠ¡ï¼ˆPostTaskï¼‰æ¥å®ç°çš„ã€‚</p>\n</blockquote>\n<h3 id="reference">Reference<a class="anchor" href="#reference"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<ul>\n<li>â­<a href="https://www.youtube.com/watch?v=8aGhZQkoFbQ">What the heck is the event loop anyway? | Philip Roberts | JSConf EU - YouTube</a></li>\n<li>â­<a href="https://www.youtube.com/watch?v=cCOL7MC4Pl0">Jake Archibald on the web browser event loop, setTimeout, micro tasks, requestAnimationFrame, â€¦ - YouTube</a></li>\n<li>[è¿™ä¸€æ¬¡ï¼Œå½»åº•å¼„æ‡‚ JavaScript æ‰§è¡Œæœºåˆ¶](<a href="https://juejin.cn/post/6844903512845860872">https://juejin.cn/post/6844903512845860872</a> <a href="https://juejin.cn/post/6844903512845860872">https://juejin.cn/post/6844903512845860872</a>)</li>\n<li>[ä» event loop è§„èŒƒæ¢ç©¶ javaScript å¼‚æ­¥åŠæµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº](<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faooy%2Fblog%2Fissues%2F5">https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faooy%2Fblog%2Fissues%2F5</a> <a href="https://github.com/aooy/blog/issues/5">https://github.com/aooy/blog/issues/5</a>)</li>\n<li>[ã€THE LAST TIMEã€‘å½»åº•åƒé€ JavaScript æ‰§è¡Œæœºåˆ¶](<a href="https://juejin.cn/post/6844903955286196237">https://juejin.cn/post/6844903955286196237</a> <a href="https://juejin.cn/post/6844903955286196237">https://juejin.cn/post/6844903955286196237</a>)</li>\n<li>[ä¸€æ¬¡å¼„æ‡‚ Event Loopï¼ˆå½»åº•è§£å†³æ­¤ç±»é¢è¯•é—®é¢˜ï¼‰](<a href="https://juejin.cn/post/6844903764202094606">https://juejin.cn/post/6844903764202094606</a> <a href="https://juejin.cn/post/6844903764202094606">https://juejin.cn/post/6844903764202094606</a>)</li>\n<li>[æ·±å…¥ç†è§£ JavaScript Event Loop](<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F34229323">https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F34229323</a> <a href="https://zhuanlan.zhihu.com/p/34229323">https://zhuanlan.zhihu.com/p/34229323</a>)</li>\n</ul>\n<h3 id="event-loop-execution-process">Event Loop Execution Process<a class="anchor" href="#event-loop-execution-process"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<ul>\n<li>\n<p>call stack > Web APIs > callback queue > ğŸ”event loop > task in callback queue? push task to the end of stack</p>\n</li>\n<li>\n<p>è°ƒç”¨æ ˆã€å †æ ˆæº¢å‡ºï¼ˆstack overflowï¼‰ã€å›è°ƒé˜Ÿåˆ—/ä»»åŠ¡é˜Ÿåˆ—ï¼ˆå›è°ƒå‡½æ•°ï¼‰ã€äº‹ä»¶å¾ªç¯ã€</p>\n</li>\n<li>\n<p>render queueï¼šé‡ç»˜</p>\n<p><img src="https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/programming/Pasted-image-20221208182251.png" alt=""></p>\n</li>\n</ul>\n<h4 id="äº‹ä»¶è½®è¯¢æœºåˆ¶æ‰§è¡Œè¿‡ç¨‹">äº‹ä»¶è½®è¯¢æœºåˆ¶æ‰§è¡Œè¿‡ç¨‹<a class="anchor" href="#äº‹ä»¶è½®è¯¢æœºåˆ¶æ‰§è¡Œè¿‡ç¨‹"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<p>1ï¼‰ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡æ”¾åœ¨ä¸åŒçš„ä»»åŠ¡é˜Ÿåˆ—ä¸­<br>\n2ï¼‰å½“æŸä¸ªå®ä»»åŠ¡æ‰§è¡Œå®Œå,ä¼šæŸ¥çœ‹å¾®ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æœ‰ä»»åŠ¡ã€‚å¦‚æœæœ‰ï¼Œæ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å¾®ä»»åŠ¡ (æ³¨æ„è¿™é‡Œæ˜¯æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡)<br>\n3ï¼‰å¾®ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œä¼šè¯»å–å®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ’åœ¨æœ€å‰çš„ç¬¬ä¸€ä¸ªå®ä»»åŠ¡ï¼ˆæ³¨æ„å®ä»»åŠ¡æ˜¯ä¸€ä¸ªä¸ªå–ï¼‰ï¼Œæ‰§è¡Œè¯¥å®ä»»åŠ¡ï¼Œå¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å¾®ä»»åŠ¡ï¼Œä¾æ¬¡åŠ å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—<br>\n4ï¼‰å®ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œå†æ¬¡è¯»å–å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ï¼Œä¾æ¬¡ç±»æ¨ã€‚</p>\n<h3 id="å®ä»»åŠ¡-å¾®ä»»åŠ¡">å®ä»»åŠ¡ å¾®ä»»åŠ¡<a class="anchor" href="#å®ä»»åŠ¡-å¾®ä»»åŠ¡"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p>å®ä»»åŠ¡æ˜¯ä¸€ä¸ªä¸ªæ‰§è¡Œï¼Œæ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼Œç„¶åå°±æŠŠåœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å¾®ä»»åŠ¡éƒ½æ‰§è¡Œå®Œï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ï¼Œå†æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ï¼Œä¾æ¬¡ç±»æ¨</p>\n<h3 id="reference-1">Reference<a class="anchor" href="#reference-1"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<ul>\n<li>[Tasks, microtasks, queues and schedules](<a href="https://link.juejin.cn/?target=https%3A%2F%2Fjakearchibald.com%2F2015%2Ftasks-microtasks-queues-and-schedules%2F">https://link.juejin.cn/?target=https%3A%2F%2Fjakearchibald.com%2F2015%2Ftasks-microtasks-queues-and-schedules%2F</a> <a href="https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/">https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/</a>)</li>\n<li><a href="https://juejin.cn/post/7020710294083092493">è¯¦è§£å®ä»»åŠ¡ã€å¾®ä»»åŠ¡ä¸äº‹ä»¶å¾ªç¯ Event Loop - æ˜é‡‘</a></li>\n</ul>\n<h3 id="å®ä»»åŠ¡macrotasks">å®ä»»åŠ¡ï¼ˆMacrotasksï¼‰<a class="anchor" href="#å®ä»»åŠ¡macrotasks"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p>ä¸»çº¿ç¨‹ä¸Šæ’é˜Ÿæ‰§è¡Œçš„ä»»åŠ¡ï¼Œåªæœ‰å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡</p>\n<ul>\n<li>script å…¨éƒ¨ä»£ç ï¼ˆæ³¨æ„åŒæ­¥ä»£ç ä¹Ÿå±äºå®ä»»åŠ¡ï¼‰</li>\n<li>setTimeoutã€setIntervalã€setImmediate ç­‰</li>\n</ul>\n<h3 id="å¾®ä»»åŠ¡microtasks">å¾®ä»»åŠ¡ï¼ˆMicrotasksï¼‰<a class="anchor" href="#å¾®ä»»åŠ¡microtasks"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p>ä¸è¿›å…¥ä¸»çº¿ç¨‹ã€è€Œè¿›å…¥ å¾®ä»»åŠ¡åˆ—è¡¨ çš„ä»»åŠ¡</p>\n<ul>\n<li>Promiseã€MutationObserver</li>\n</ul>\n<h3 id="event-loop-ä¸-æµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº">Event loop ä¸ æµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº<a class="anchor" href="#event-loop-ä¸-æµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3>\n<p>1ï¼‰ æµè§ˆå™¨æ›´æ–°æ¸²æŸ“ä¼šåœ¨ event loop ä¸­çš„ å®ä»»åŠ¡ å’Œ å¾®ä»»åŠ¡ å®Œæˆåè¿›è¡Œï¼Œå³ <code>å®ä»»åŠ¡ â†’ å¾®ä»»åŠ¡ â†’ æ¸²æŸ“æ›´æ–°</code>ï¼ˆå…ˆå®ä»»åŠ¡ å†å¾®ä»»åŠ¡ï¼Œç„¶åå†æ¸²æŸ“æ›´æ–°ï¼‰<br>\n2ï¼‰å®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœæœ‰å¤§é‡ä»»åŠ¡ç­‰å¾…æ‰§è¡Œæ—¶ï¼Œå°† <code>domçš„å˜åŠ¨ä½œä¸ºå¾®ä»»åŠ¡ï¼Œèƒ½æ›´å¿«çš„å°†å˜åŒ–å‘ˆç°ç»™ç”¨æˆ·</code>ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™ä¸€æ¬¡çš„äº‹ä»¶è½®è¯¢ä¸­æ›´æ–° dom</p>\n<h2 id="requestanimationframe"><code>requestAnimationFrame</code><a class="anchor" href="#requestanimationframe"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>\n<ul>\n<li><a href="https://juejin.cn/post/6991297852462858277?searchId=202402181438115229F57507550A5779CE">ã€ä»Šå¤©ä½ æ›´åšå­¦äº†ä¹ˆã€‘ä¸€ä¸ªç¥å¥‡çš„å‰ç«¯åŠ¨ç”» API requestAnimationFrame - æ˜é‡‘</a></li>\n<li><a href="https://juejin.cn/post/7190728064458817591?searchId=202402181438115229F57507550A5779CE">æ€§èƒ½ä¼˜åŒ–ä¹‹é€šä¿—æ˜“æ‡‚å­¦ä¹  requestAnimationFrame å’Œä½¿ç”¨åœºæ™¯ä¸¾ä¾‹ - æ˜é‡‘</a></li>\n<li><a href="https://juejin.cn/post/7274346507037016104?searchId=202402181438115229F57507550A5779CE">å¦ä¸€ç§æ¸²æŸ“å¤§é‡æ•°æ®çš„é«˜æ•ˆæ–¹æ³•ï¼šrequestAnimationFrame - æ˜é‡‘</a></li>\n<li><a href="https://juejin.cn/post/7262900590937063482?searchId=202402181438115229F57507550A5779CE">åˆ©ç”¨ requestAnimationFrame ä¼˜åŒ–å¤§æ•°æ®åˆ—è¡¨æ¸²æŸ“ - æ˜é‡‘</a></li>\n</ul>\n<h2 id="ï¸-interview-exercise">ğŸ› ï¸ Interview Exercise<a class="anchor" href="#ï¸-interview-exercise"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>\n<h4 id="event-loop-ç»å…¸é¢˜ç›®åˆ¤æ–­æ‰“å°ç»“æœ">Event Loop ç»å…¸é¢˜ç›®ï¼šåˆ¤æ–­æ‰“å°ç»“æœ<a class="anchor" href="#event-loop-ç»å…¸é¢˜ç›®åˆ¤æ–­æ‰“å°ç»“æœ"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#79B8FF">Promise</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">resolve</span><span style="color:#E1E4E8">()</span></span>\n<span class="line"><span style="color:#E1E4E8">\t.</span><span style="color:#B392F0">then</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> () {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(promise0);</span></span>\n<span class="line"><span style="color:#E1E4E8">\t})</span></span>\n<span class="line"><span style="color:#E1E4E8">\t.</span><span style="color:#B392F0">then</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> () {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(promise5);</span></span>\n<span class="line"><span style="color:#E1E4E8">\t});</span></span>\n<span class="line"><span style="color:#B392F0">setTimeout</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#E1E4E8">\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(timer1);</span></span>\n<span class="line"><span style="color:#79B8FF">\tPromise</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">resolve</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">then</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> () {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(promise2);</span></span>\n<span class="line"><span style="color:#E1E4E8">\t});</span></span>\n<span class="line"><span style="color:#79B8FF">\tPromise</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">resolve</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">then</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> () {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(promise4);</span></span>\n<span class="line"><span style="color:#E1E4E8">\t});</span></span>\n<span class="line"><span style="color:#E1E4E8">}, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#B392F0">setTimeout</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#E1E4E8">\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(timer2);</span></span>\n<span class="line"><span style="color:#79B8FF">\tPromise</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">resolve</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">then</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> () {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(promise3);</span></span>\n<span class="line"><span style="color:#E1E4E8">\t});</span></span>\n<span class="line"><span style="color:#E1E4E8">}, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#79B8FF">Promise</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">resolve</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">then</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> () {</span></span>\n<span class="line"><span style="color:#E1E4E8">\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(promise1);</span></span>\n<span class="line"><span style="color:#E1E4E8">});</span></span>\n<span class="line"><span style="color:#E1E4E8">console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(start);</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A737D">// æ‰“å°ç»“æœï¼š start promise0 promise1 promise5 timer1 promise2 promise4 timer2 promise3</span></span>\n<span class="line"></span></code></pre>\n<h4 id="äº‹ä»¶è½®è¯¢æ‰§è¡Œæ—¶æœº">äº‹ä»¶è½®è¯¢æ‰§è¡Œæ—¶æœº<a class="anchor" href="#äº‹ä»¶è½®è¯¢æ‰§è¡Œæ—¶æœº"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h4>\n<p>async éšå¼è¿”å› Promiseï¼Œä¼šäº§ç”Ÿä¸€ä¸ªå¾®ä»»åŠ¡ï¼Œawait åé¢çš„ä»£ç æ˜¯åœ¨å¾®ä»»åŠ¡æ—¶æ‰§è¡Œ</p>\n<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(script start);</span></span>\n<span class="line"><span style="color:#F97583">async</span><span style="color:#F97583"> function</span><span style="color:#B392F0"> async1</span><span style="color:#E1E4E8">() {</span></span>\n<span class="line"><span style="color:#F97583">\tawait</span><span style="color:#B392F0"> async2</span><span style="color:#E1E4E8">(); </span><span style="color:#6A737D">// await éšå¼è¿”å›promise</span></span>\n<span class="line"><span style="color:#E1E4E8">\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(async1 end); </span><span style="color:#6A737D">// è¿™é‡Œçš„æ‰§è¡Œæ—¶æœºï¼šåœ¨æ‰§è¡Œå¾®ä»»åŠ¡æ—¶æ‰§è¡Œ</span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"><span style="color:#F97583">async</span><span style="color:#F97583"> function</span><span style="color:#B392F0"> async2</span><span style="color:#E1E4E8">() {</span></span>\n<span class="line"><span style="color:#E1E4E8">\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(async2 end); </span><span style="color:#6A737D">// è¿™é‡Œæ˜¯åŒæ­¥ä»£ç </span></span>\n<span class="line"><span style="color:#E1E4E8">}</span></span>\n<span class="line"><span style="color:#B392F0">async1</span><span style="color:#E1E4E8">();</span></span>\n<span class="line"><span style="color:#B392F0">setTimeout</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> () {</span></span>\n<span class="line"><span style="color:#E1E4E8">\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(setTimeout);</span></span>\n<span class="line"><span style="color:#E1E4E8">}, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">);</span></span>\n<span class="line"><span style="color:#F97583">new</span><span style="color:#79B8FF"> Promise</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">resolve</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>\n<span class="line"><span style="color:#E1E4E8">\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">Promise</span><span style="color:#E1E4E8">); </span><span style="color:#6A737D">// è¿™é‡Œæ˜¯åŒæ­¥ä»£ç </span></span>\n<span class="line"><span style="color:#B392F0">\tresolve</span><span style="color:#E1E4E8">();</span></span>\n<span class="line"><span style="color:#E1E4E8">})</span></span>\n<span class="line"><span style="color:#E1E4E8">\t.</span><span style="color:#B392F0">then</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> () {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(promise1);</span></span>\n<span class="line"><span style="color:#E1E4E8">\t})</span></span>\n<span class="line"><span style="color:#E1E4E8">\t.</span><span style="color:#B392F0">then</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> () {</span></span>\n<span class="line"><span style="color:#E1E4E8">\t\tconsole.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(promise2);</span></span>\n<span class="line"><span style="color:#E1E4E8">\t});</span></span>\n<span class="line"><span style="color:#E1E4E8">console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(script end);</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A737D">// æ‰“å°ç»“æœ:  script start => async2 end => Promise => script end => async1 end => promise1 => promise2 => setTimeout</span></span>\n<span class="line"></span></code></pre>\n<h2 id="nodejs-event-loop">â“<a href="Node.js-Event-Loop">Node.js Event Loop</a><a class="anchor" href="#nodejs-event-loop"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>\n<h2 id="vue-å¼‚æ­¥æ›´æ–°-event-loop-ä¸-vue-nexttickvue-å¼‚æ­¥æ›´æ–°-event-loop-ä¸-vue-nexttick">â“[Vue å¼‚æ­¥æ›´æ–° (Event loop ä¸ Vue nextTick)](&#x3C;../Vue-å¼‚æ­¥æ›´æ–°-(Event-loop-ä¸-Vue-nextTick)>>)<a class="anchor" href="#vue-å¼‚æ­¥æ›´æ–°-event-loop-ä¸-vue-nexttickvue-å¼‚æ­¥æ›´æ–°-event-loop-ä¸-vue-nexttick"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2>',frontmatter={tags:["JavaScript"],Datereviewed:"2024-02-18T00:00:00.000Z",comment:null,type:"D",title:"Event Loop-äº‹ä»¶å¾ªç¯",DateStarted:"2022-12-08T00:00:00.000Z",DateModified:"2024-04-18T00:00:00.000Z",status:null,difficulty:"Hard",reviewed:2,topic:["Async"],category:"Programming",minutes:6,words:1128},file="E:/SynologyDrive/Codespace/blog-site/mynote/my-fuwari-blog/src/content/posts/js/data-fetching/event-loop-äº‹ä»¶å¾ªç¯.md",url=void 0;function rawContent(){return"\n# Event Loop-äº‹ä»¶å¾ªç¯\n\n## What is JavaScript?\n\n- [How JavaScript works](https://link.juejin.cn/?target=https%3A%2F%2Fblog.sessionstack.com%2Fhow-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5 https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5)\n- A **single-threaded** non-blocking asynchronous concurrent language.\n- å•çº¿ç¨‹ã€æ— é˜»å¡ã€å¼‚æ­¥ã€å¹¶å‘\n- Have **a call stack**, an event loop, a callback queue and other APIs...\n\n### V8\n\n- A JS runtime\n- Have a callstack and a heap\n- The V8 can do one thing at a time, but not the browser which can access other APIs.\n\n## Event Loop (äº‹ä»¶è½®è¯¢æœºåˆ¶)\n\n### macrotask çš„æœ¬è´¨\n\n[æ·±å…¥æµè§ˆå™¨äº‹ä»¶å¾ªç¯çš„æœ¬è´¨ Â· Issue #160 Â· frontend9/fe9-library Â· GitHub](https://github.com/frontend9/fe9-library/issues/160)\n\n> macrotask æœ¬è´¨ä¸Šæ˜¯æµè§ˆå™¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´é€šä¿¡çš„ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—  \n> åœ¨ chrome é‡Œï¼Œæ¯ä¸ªé¡µé¢éƒ½å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹åˆæœ‰å¤šä¸ªçº¿ç¨‹ï¼Œæ¯”å¦‚ js çº¿ç¨‹ã€æ¸²æŸ“çº¿ç¨‹ã€io çº¿ç¨‹ã€ç½‘ç»œçº¿ç¨‹ã€å®šæ—¶å™¨çº¿ç¨‹ç­‰ï¼Œè¿™äº›çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œæ˜¯é€šè¿‡å‘å¯¹æ–¹çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªä»»åŠ¡ï¼ˆPostTaskï¼‰æ¥å®ç°çš„ã€‚\n\n### Reference\n\n- â­[What the heck is the event loop anyway? | Philip Roberts | JSConf EU - YouTube](https://www.youtube.com/watch?v=8aGhZQkoFbQ)\n- â­[Jake Archibald on the web browser event loop, setTimeout, micro tasks, requestAnimationFrame, ... - YouTube](https://www.youtube.com/watch?v=cCOL7MC4Pl0)\n- [è¿™ä¸€æ¬¡ï¼Œå½»åº•å¼„æ‡‚ JavaScript æ‰§è¡Œæœºåˆ¶](https://juejin.cn/post/6844903512845860872 https://juejin.cn/post/6844903512845860872)\n- [ä» event loop è§„èŒƒæ¢ç©¶ javaScript å¼‚æ­¥åŠæµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faooy%2Fblog%2Fissues%2F5 https://github.com/aooy/blog/issues/5)\n- [ã€THE LAST TIMEã€‘å½»åº•åƒé€ JavaScript æ‰§è¡Œæœºåˆ¶](https://juejin.cn/post/6844903955286196237 https://juejin.cn/post/6844903955286196237)\n- [ä¸€æ¬¡å¼„æ‡‚ Event Loopï¼ˆå½»åº•è§£å†³æ­¤ç±»é¢è¯•é—®é¢˜ï¼‰](https://juejin.cn/post/6844903764202094606 https://juejin.cn/post/6844903764202094606)\n- [æ·±å…¥ç†è§£ JavaScript Event Loop](https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F34229323 https://zhuanlan.zhihu.com/p/34229323)\n\n### Event Loop Execution Process\n\n- call stack > Web APIs > callback queue > ğŸ”event loop > task in callback queue? push task to the end of stack\n- è°ƒç”¨æ ˆã€å †æ ˆæº¢å‡ºï¼ˆstack overflowï¼‰ã€å›è°ƒé˜Ÿåˆ—/ä»»åŠ¡é˜Ÿåˆ—ï¼ˆå›è°ƒå‡½æ•°ï¼‰ã€äº‹ä»¶å¾ªç¯ã€\n- render queueï¼šé‡ç»˜\n\n  ![](https://cdn.jsdelivr.net/gh/jenniferwonder/bimg/programming/Pasted-image-20221208182251.png)\n\n#### äº‹ä»¶è½®è¯¢æœºåˆ¶æ‰§è¡Œè¿‡ç¨‹\n\n1ï¼‰ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡æ”¾åœ¨ä¸åŒçš„ä»»åŠ¡é˜Ÿåˆ—ä¸­  \n2ï¼‰å½“æŸä¸ªå®ä»»åŠ¡æ‰§è¡Œå®Œå,ä¼šæŸ¥çœ‹å¾®ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æœ‰ä»»åŠ¡ã€‚å¦‚æœæœ‰ï¼Œæ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å¾®ä»»åŠ¡ (æ³¨æ„è¿™é‡Œæ˜¯æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡)  \n3ï¼‰å¾®ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œä¼šè¯»å–å®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ’åœ¨æœ€å‰çš„ç¬¬ä¸€ä¸ªå®ä»»åŠ¡ï¼ˆæ³¨æ„å®ä»»åŠ¡æ˜¯ä¸€ä¸ªä¸ªå–ï¼‰ï¼Œæ‰§è¡Œè¯¥å®ä»»åŠ¡ï¼Œå¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å¾®ä»»åŠ¡ï¼Œä¾æ¬¡åŠ å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—  \n4ï¼‰å®ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œå†æ¬¡è¯»å–å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ï¼Œä¾æ¬¡ç±»æ¨ã€‚\n\n### å®ä»»åŠ¡ å¾®ä»»åŠ¡\n\nå®ä»»åŠ¡æ˜¯ä¸€ä¸ªä¸ªæ‰§è¡Œï¼Œæ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼Œç„¶åå°±æŠŠåœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å¾®ä»»åŠ¡éƒ½æ‰§è¡Œå®Œï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ï¼Œå†æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ï¼Œä¾æ¬¡ç±»æ¨\n\n### Reference\n\n- [Tasks, microtasks, queues and schedules](https://link.juejin.cn/?target=https%3A%2F%2Fjakearchibald.com%2F2015%2Ftasks-microtasks-queues-and-schedules%2F https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/)\n- [è¯¦è§£å®ä»»åŠ¡ã€å¾®ä»»åŠ¡ä¸äº‹ä»¶å¾ªç¯ Event Loop - æ˜é‡‘](https://juejin.cn/post/7020710294083092493)\n\n### å®ä»»åŠ¡ï¼ˆMacrotasksï¼‰\n\nä¸»çº¿ç¨‹ä¸Šæ’é˜Ÿæ‰§è¡Œçš„ä»»åŠ¡ï¼Œåªæœ‰å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡\n\n- script å…¨éƒ¨ä»£ç ï¼ˆæ³¨æ„åŒæ­¥ä»£ç ä¹Ÿå±äºå®ä»»åŠ¡ï¼‰\n- setTimeoutã€setIntervalã€setImmediate ç­‰\n\n### å¾®ä»»åŠ¡ï¼ˆMicrotasksï¼‰\n\nä¸è¿›å…¥ä¸»çº¿ç¨‹ã€è€Œè¿›å…¥ å¾®ä»»åŠ¡åˆ—è¡¨ çš„ä»»åŠ¡\n\n- Promiseã€MutationObserver\n\n### Event loop ä¸ æµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº\n\n1ï¼‰ æµè§ˆå™¨æ›´æ–°æ¸²æŸ“ä¼šåœ¨ event loop ä¸­çš„ å®ä»»åŠ¡ å’Œ å¾®ä»»åŠ¡ å®Œæˆåè¿›è¡Œï¼Œå³ `å®ä»»åŠ¡ â†’ å¾®ä»»åŠ¡ â†’ æ¸²æŸ“æ›´æ–°`ï¼ˆå…ˆå®ä»»åŠ¡ å†å¾®ä»»åŠ¡ï¼Œç„¶åå†æ¸²æŸ“æ›´æ–°ï¼‰  \n2ï¼‰å®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœæœ‰å¤§é‡ä»»åŠ¡ç­‰å¾…æ‰§è¡Œæ—¶ï¼Œå°† `domçš„å˜åŠ¨ä½œä¸ºå¾®ä»»åŠ¡ï¼Œèƒ½æ›´å¿«çš„å°†å˜åŒ–å‘ˆç°ç»™ç”¨æˆ·`ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™ä¸€æ¬¡çš„äº‹ä»¶è½®è¯¢ä¸­æ›´æ–° dom\n\n## `requestAnimationFrame`\n\n- [ã€ä»Šå¤©ä½ æ›´åšå­¦äº†ä¹ˆã€‘ä¸€ä¸ªç¥å¥‡çš„å‰ç«¯åŠ¨ç”» API requestAnimationFrame - æ˜é‡‘](https://juejin.cn/post/6991297852462858277?searchId=202402181438115229F57507550A5779CE)\n- [æ€§èƒ½ä¼˜åŒ–ä¹‹é€šä¿—æ˜“æ‡‚å­¦ä¹  requestAnimationFrame å’Œä½¿ç”¨åœºæ™¯ä¸¾ä¾‹ - æ˜é‡‘](https://juejin.cn/post/7190728064458817591?searchId=202402181438115229F57507550A5779CE)\n- [å¦ä¸€ç§æ¸²æŸ“å¤§é‡æ•°æ®çš„é«˜æ•ˆæ–¹æ³•ï¼šrequestAnimationFrame - æ˜é‡‘](https://juejin.cn/post/7274346507037016104?searchId=202402181438115229F57507550A5779CE)\n- [åˆ©ç”¨ requestAnimationFrame ä¼˜åŒ–å¤§æ•°æ®åˆ—è¡¨æ¸²æŸ“ - æ˜é‡‘](https://juejin.cn/post/7262900590937063482?searchId=202402181438115229F57507550A5779CE)\n\n## ğŸ› ï¸ Interview Exercise\n\n#### Event Loop ç»å…¸é¢˜ç›®ï¼šåˆ¤æ–­æ‰“å°ç»“æœ\n\n```javascript\nPromise.resolve()\n\t.then(function () {\n\t\tconsole.log(promise0);\n\t})\n\t.then(function () {\n\t\tconsole.log(promise5);\n\t});\nsetTimeout(() => {\n\tconsole.log(timer1);\n\tPromise.resolve().then(function () {\n\t\tconsole.log(promise2);\n\t});\n\tPromise.resolve().then(function () {\n\t\tconsole.log(promise4);\n\t});\n}, 0);\nsetTimeout(() => {\n\tconsole.log(timer2);\n\tPromise.resolve().then(function () {\n\t\tconsole.log(promise3);\n\t});\n}, 0);\nPromise.resolve().then(function () {\n\tconsole.log(promise1);\n});\nconsole.log(start);\n\n// æ‰“å°ç»“æœï¼š start promise0 promise1 promise5 timer1 promise2 promise4 timer2 promise3\n```\n\n#### äº‹ä»¶è½®è¯¢æ‰§è¡Œæ—¶æœº\n\nasync éšå¼è¿”å› Promiseï¼Œä¼šäº§ç”Ÿä¸€ä¸ªå¾®ä»»åŠ¡ï¼Œawait åé¢çš„ä»£ç æ˜¯åœ¨å¾®ä»»åŠ¡æ—¶æ‰§è¡Œ\n\n```javascript\nconsole.log(script start);\nasync function async1() {\n\tawait async2(); // await éšå¼è¿”å›promise\n\tconsole.log(async1 end); // è¿™é‡Œçš„æ‰§è¡Œæ—¶æœºï¼šåœ¨æ‰§è¡Œå¾®ä»»åŠ¡æ—¶æ‰§è¡Œ\n}\nasync function async2() {\n\tconsole.log(async2 end); // è¿™é‡Œæ˜¯åŒæ­¥ä»£ç \n}\nasync1();\nsetTimeout(function () {\n\tconsole.log(setTimeout);\n}, 0);\nnew Promise((resolve) => {\n\tconsole.log(Promise); // è¿™é‡Œæ˜¯åŒæ­¥ä»£ç \n\tresolve();\n})\n\t.then(function () {\n\t\tconsole.log(promise1);\n\t})\n\t.then(function () {\n\t\tconsole.log(promise2);\n\t});\nconsole.log(script end);\n\n// æ‰“å°ç»“æœ:  script start => async2 end => Promise => script end => async1 end => promise1 => promise2 => setTimeout\n```\n\n## â“[Node.js Event Loop](Node.js-Event-Loop)\n\n## â“[Vue å¼‚æ­¥æ›´æ–° (Event loop ä¸ Vue nextTick)](<../Vue-å¼‚æ­¥æ›´æ–°-(Event-loop-ä¸-Vue-nextTick)>>)\n"}function compiledContent(){return html}function getHeadings(){return[{depth:1,slug:"event-loop-äº‹ä»¶å¾ªç¯",text:"Event Loop-äº‹ä»¶å¾ªç¯#"},{depth:2,slug:"what-is-javascript",text:"What is JavaScript?#"},{depth:3,slug:"v8",text:"V8#"},{depth:2,slug:"event-loop-äº‹ä»¶è½®è¯¢æœºåˆ¶",text:"Event Loop (äº‹ä»¶è½®è¯¢æœºåˆ¶)#"},{depth:3,slug:"macrotask-çš„æœ¬è´¨",text:"macrotask çš„æœ¬è´¨#"},{depth:3,slug:"reference",text:"Reference#"},{depth:3,slug:"event-loop-execution-process",text:"Event Loop Execution Process#"},{depth:4,slug:"äº‹ä»¶è½®è¯¢æœºåˆ¶æ‰§è¡Œè¿‡ç¨‹",text:"äº‹ä»¶è½®è¯¢æœºåˆ¶æ‰§è¡Œè¿‡ç¨‹#"},{depth:3,slug:"å®ä»»åŠ¡-å¾®ä»»åŠ¡",text:"å®ä»»åŠ¡ å¾®ä»»åŠ¡#"},{depth:3,slug:"reference-1",text:"Reference#"},{depth:3,slug:"å®ä»»åŠ¡macrotasks",text:"å®ä»»åŠ¡ï¼ˆMacrotasksï¼‰#"},{depth:3,slug:"å¾®ä»»åŠ¡microtasks",text:"å¾®ä»»åŠ¡ï¼ˆMicrotasksï¼‰#"},{depth:3,slug:"event-loop-ä¸-æµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº",text:"Event loop ä¸ æµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº#"},{depth:2,slug:"requestanimationframe",text:"requestAnimationFrame#"},{depth:2,slug:"ï¸-interview-exercise",text:"ğŸ› ï¸ Interview Exercise#"},{depth:4,slug:"event-loop-ç»å…¸é¢˜ç›®åˆ¤æ–­æ‰“å°ç»“æœ",text:"Event Loop ç»å…¸é¢˜ç›®ï¼šåˆ¤æ–­æ‰“å°ç»“æœ#"},{depth:4,slug:"äº‹ä»¶è½®è¯¢æ‰§è¡Œæ—¶æœº",text:"äº‹ä»¶è½®è¯¢æ‰§è¡Œæ—¶æœº#"},{depth:2,slug:"nodejs-event-loop",text:"â“Node.js Event Loop#"},{depth:2,slug:"vue-å¼‚æ­¥æ›´æ–°-event-loop-ä¸-vue-nexttickvue-å¼‚æ­¥æ›´æ–°-event-loop-ä¸-vue-nexttick",text:"â“[Vue å¼‚æ­¥æ›´æ–° (Event loop ä¸ Vue nextTick)](<../Vue-å¼‚æ­¥æ›´æ–°-(Event-loop-ä¸-Vue-nextTick)>>)#"}]}const Content=createComponent(((n,s,e)=>{const{layout:o,...t}=frontmatter;return t.file=file,t.url=url,renderTemplate`${maybeRenderHead()}${unescapeHTML(html)}`})),eventLoop_____=Object.freeze(Object.defineProperty({__proto__:null,Content:Content,compiledContent:compiledContent,default:Content,file:file,frontmatter:frontmatter,getHeadings:getHeadings,rawContent:rawContent,url:url},Symbol.toStringTag,{value:"Module"}));export{_internal,body,collection,data,eventLoop_____,id,slug};